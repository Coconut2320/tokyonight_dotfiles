"use strict";var Ea=Object.create;var Mt=Object.defineProperty;var ya=Object.getOwnPropertyDescriptor;var ba=Object.getOwnPropertyNames;var Ra=Object.getPrototypeOf,Ia=Object.prototype.hasOwnProperty;var R=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),va=(t,e)=>{for(var r in e)Mt(t,r,{get:e[r],enumerable:!0})},os=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of ba(e))!Ia.call(t,s)&&s!==r&&Mt(t,s,{get:()=>e[s],enumerable:!(n=ya(e,s))||n.enumerable});return t};var S=(t,e,r)=>(r=t!=null?Ea(Ra(t)):{},os(e||!t||!t.__esModule?Mt(r,"default",{value:t,enumerable:!0}):r,t)),xa=t=>os(Mt({},"__esModule",{value:!0}),t);var Es=R((cd,Ht)=>{var ka=function(){"use strict";function t(u,p){return p!=null&&u instanceof p}var e;try{e=Map}catch{e=function(){}}var r;try{r=Set}catch{r=function(){}}var n;try{n=Promise}catch{n=function(){}}function s(u,p,d,m,b){typeof p=="object"&&(d=p.depth,m=p.prototype,b=p.includeNonEnumerable,p=p.circular);var I=[],K=[],D=typeof Buffer<"u";typeof p>"u"&&(p=!0),typeof d>"u"&&(d=1/0);function U(v,re){if(v===null)return null;if(re===0)return v;var T,ge;if(typeof v!="object")return v;if(t(v,e))T=new e;else if(t(v,r))T=new r;else if(t(v,n))T=new n(function(ut,pt){v.then(function(ft){ut(U(ft,re-1))},function(ft){pt(U(ft,re-1))})});else if(s.__isArray(v))T=[];else if(s.__isRegExp(v))T=new RegExp(v.source,l(v)),v.lastIndex&&(T.lastIndex=v.lastIndex);else if(s.__isDate(v))T=new Date(v.getTime());else{if(D&&Buffer.isBuffer(v))return Buffer.allocUnsafe?T=Buffer.allocUnsafe(v.length):T=new Buffer(v.length),v.copy(T),T;t(v,Error)?T=Object.create(v):typeof m>"u"?(ge=Object.getPrototypeOf(v),T=Object.create(ge)):(T=Object.create(m),ge=m)}if(p){var ns=I.indexOf(v);if(ns!=-1)return K[ns];I.push(v),K.push(T)}t(v,e)&&v.forEach(function(ut,pt){var ft=U(pt,re-1),ga=U(ut,re-1);T.set(ft,ga)}),t(v,r)&&v.forEach(function(ut){var pt=U(ut,re-1);T.add(pt)});for(var pe in v){var qr;ge&&(qr=Object.getOwnPropertyDescriptor(ge,pe)),!(qr&&qr.set==null)&&(T[pe]=U(v[pe],re-1))}if(Object.getOwnPropertySymbols)for(var ss=Object.getOwnPropertySymbols(v),pe=0;pe<ss.length;pe++){var Ut=ss[pe],Fe=Object.getOwnPropertyDescriptor(v,Ut);Fe&&!Fe.enumerable&&!b||(T[Ut]=U(v[Ut],re-1),Fe.enumerable||Object.defineProperty(T,Ut,{enumerable:!1}))}if(b)for(var is=Object.getOwnPropertyNames(v),pe=0;pe<is.length;pe++){var qt=is[pe],Fe=Object.getOwnPropertyDescriptor(v,qt);Fe&&Fe.enumerable||(T[qt]=U(v[qt],re-1),Object.defineProperty(T,qt,{enumerable:!1}))}return T}return U(u,d)}s.clonePrototype=function(p){if(p===null)return null;var d=function(){};return d.prototype=p,new d};function i(u){return Object.prototype.toString.call(u)}s.__objToStr=i;function o(u){return typeof u=="object"&&i(u)==="[object Date]"}s.__isDate=o;function c(u){return typeof u=="object"&&i(u)==="[object Array]"}s.__isArray=c;function a(u){return typeof u=="object"&&i(u)==="[object RegExp]"}s.__isRegExp=a;function l(u){var p="";return u.global&&(p+="g"),u.ignoreCase&&(p+="i"),u.multiline&&(p+="m"),p}return s.__getRegExpFlags=l,s}();typeof Ht=="object"&&Ht.exports&&(Ht.exports=ka)});var Rs=R((ys,bs)=>{(function(){var t,e,r,n=[].splice,s=function(o,c){if(!(o instanceof c))throw new Error("Bound instance method accessed before binding")},i=[].indexOf;r=Es(),t=require("events").EventEmitter,bs.exports=e=function(){class o extends t{constructor(a={}){super(),this.get=this.get.bind(this),this.mget=this.mget.bind(this),this.set=this.set.bind(this),this.mset=this.mset.bind(this),this.del=this.del.bind(this),this.take=this.take.bind(this),this.ttl=this.ttl.bind(this),this.getTtl=this.getTtl.bind(this),this.keys=this.keys.bind(this),this.has=this.has.bind(this),this.getStats=this.getStats.bind(this),this.flushAll=this.flushAll.bind(this),this.flushStats=this.flushStats.bind(this),this.close=this.close.bind(this),this._checkData=this._checkData.bind(this),this._check=this._check.bind(this),this._isInvalidKey=this._isInvalidKey.bind(this),this._wrap=this._wrap.bind(this),this._getValLength=this._getValLength.bind(this),this._error=this._error.bind(this),this._initErrors=this._initErrors.bind(this),this.options=a,this._initErrors(),this.data={},this.options=Object.assign({forceString:!1,objectValueSize:80,promiseValueSize:80,arrayValueSize:40,stdTTL:0,checkperiod:600,useClones:!0,deleteOnExpire:!0,enableLegacyCallbacks:!1,maxKeys:-1},this.options),this.options.enableLegacyCallbacks&&(console.warn("WARNING! node-cache legacy callback support will drop in v6.x"),["get","mget","set","del","ttl","getTtl","keys","has"].forEach(l=>{var u;u=this[l],this[l]=function(...p){var d,m,b,I;if(b=p,[...p]=b,[d]=n.call(p,-1),typeof d=="function")try{I=u(...p),d(null,I)}catch(K){m=K,d(m)}else return u(...p,d)}})),this.stats={hits:0,misses:0,keys:0,ksize:0,vsize:0},this.validKeyTypes=["string","number"],this._checkData()}get(a){var l,u;if(s(this,o),(u=this._isInvalidKey(a))!=null)throw u;if(this.data[a]!=null&&this._check(a,this.data[a]))return this.stats.hits++,l=this._unwrap(this.data[a]),l;this.stats.misses++}mget(a){var l,u,p,d,m,b;if(s(this,o),!Array.isArray(a))throw l=this._error("EKEYSTYPE"),l;for(b={},p=0,m=a.length;p<m;p++){if(d=a[p],(u=this._isInvalidKey(d))!=null)throw u;this.data[d]!=null&&this._check(d,this.data[d])?(this.stats.hits++,b[d]=this._unwrap(this.data[d])):this.stats.misses++}return b}set(a,l,u){var p,d,m;if(s(this,o),this.options.maxKeys>-1&&this.stats.keys>=this.options.maxKeys)throw p=this._error("ECACHEFULL"),p;if(this.options.forceString&&!1==="string"&&(l=JSON.stringify(l)),u==null&&(u=this.options.stdTTL),(d=this._isInvalidKey(a))!=null)throw d;return m=!1,this.data[a]&&(m=!0,this.stats.vsize-=this._getValLength(this._unwrap(this.data[a],!1))),this.data[a]=this._wrap(l,u),this.stats.vsize+=this._getValLength(l),m||(this.stats.ksize+=this._getKeyLength(a),this.stats.keys++),this.emit("set",a,l),!0}mset(a){var l,u,p,d,m,b,I,K,D,U;if(s(this,o),this.options.maxKeys>-1&&this.stats.keys+a.length>=this.options.maxKeys)throw l=this._error("ECACHEFULL"),l;for(p=0,I=a.length;p<I;p++){if(b=a[p],{key:m,val:U,ttl:D}=b,D&&typeof D!="number")throw l=this._error("ETTLTYPE"),l;if((u=this._isInvalidKey(m))!=null)throw u}for(d=0,K=a.length;d<K;d++)b=a[d],{key:m,val:U,ttl:D}=b,this.set(m,U,D);return!0}del(a){var l,u,p,d,m,b;for(s(this,o),Array.isArray(a)||(a=[a]),l=0,p=0,m=a.length;p<m;p++){if(d=a[p],(u=this._isInvalidKey(d))!=null)throw u;this.data[d]!=null&&(this.stats.vsize-=this._getValLength(this._unwrap(this.data[d],!1)),this.stats.ksize-=this._getKeyLength(d),this.stats.keys--,l++,b=this.data[d],delete this.data[d],this.emit("del",d,b.v))}return l}take(a){var l;return s(this,o),l=this.get(a),l!=null&&this.del(a),l}ttl(a,l){var u;if(s(this,o),l||(l=this.options.stdTTL),!a)return!1;if((u=this._isInvalidKey(a))!=null)throw u;return this.data[a]!=null&&this._check(a,this.data[a])?(l>=0?this.data[a]=this._wrap(this.data[a].v,l,!1):this.del(a),!0):!1}getTtl(a){var l,u;if(s(this,o),!!a){if((u=this._isInvalidKey(a))!=null)throw u;if(this.data[a]!=null&&this._check(a,this.data[a]))return l=this.data[a].t,l}}keys(){var a;return s(this,o),a=Object.keys(this.data),a}has(a){var l;return s(this,o),l=this.data[a]!=null&&this._check(a,this.data[a]),l}getStats(){return s(this,o),this.stats}flushAll(a=!0){s(this,o),this.data={},this.stats={hits:0,misses:0,keys:0,ksize:0,vsize:0},this._killCheckPeriod(),this._checkData(a),this.emit("flush")}flushStats(){s(this,o),this.stats={hits:0,misses:0,keys:0,ksize:0,vsize:0},this.emit("flush_stats")}close(){s(this,o),this._killCheckPeriod()}_checkData(a=!0){var l,u,p;s(this,o),u=this.data;for(l in u)p=u[l],this._check(l,p);a&&this.options.checkperiod>0&&(this.checkTimeout=setTimeout(this._checkData,this.options.checkperiod*1e3,a),this.checkTimeout!=null&&this.checkTimeout.unref!=null&&this.checkTimeout.unref())}_killCheckPeriod(){if(this.checkTimeout!=null)return clearTimeout(this.checkTimeout)}_check(a,l){var u;return s(this,o),u=!0,l.t!==0&&l.t<Date.now()&&(this.options.deleteOnExpire&&(u=!1,this.del(a)),this.emit("expired",a,this._unwrap(l))),u}_isInvalidKey(a){var l;if(s(this,o),l=typeof a,i.call(this.validKeyTypes,l)<0)return this._error("EKEYTYPE",{type:typeof a})}_wrap(a,l,u=!0){var p,d,m,b;return s(this,o),this.options.useClones||(u=!1),d=Date.now(),p=0,b=1e3,l===0?p=0:l?p=d+l*b:this.options.stdTTL===0?p=this.options.stdTTL:p=d+this.options.stdTTL*b,m={t:p,v:u?r(a):a}}_unwrap(a,l=!0){return this.options.useClones||(l=!1),a.v!=null?l?r(a.v):a.v:null}_getKeyLength(a){return a.toString().length}_getValLength(a){return s(this,o),typeof a=="string"?a.length:this.options.forceString?JSON.stringify(a).length:Array.isArray(a)?this.options.arrayValueSize*a.length:typeof a=="number"?8:typeof a?.then=="function"?this.options.promiseValueSize:typeof Buffer<"u"&&Buffer!==null&&Buffer.isBuffer(a)?a.length:a!=null&&typeof a=="object"?this.options.objectValueSize*Object.keys(a).length:typeof a=="boolean"?8:0}_error(a,l={}){var u;return s(this,o),u=new Error,u.name=a,u.errorcode=a,u.message=this.ERRORS[a]!=null?this.ERRORS[a](l):"-",u.data=l,u}_initErrors(){var a,l,u;s(this,o),this.ERRORS={},u=this._ERRORS;for(l in u)a=u[l],this.ERRORS[l]=this.createErrorMessage(a)}createErrorMessage(a){return function(l){return a.replace("__key",l.type)}}}return o.prototype._ERRORS={ENOTFOUND:"Key `__key` not found",ECACHEFULL:"Cache max keys amount exceeded",EKEYTYPE:"The key argument has to be of type `string` or `number`. Found: `__key`",EKEYSTYPE:"The keys argument has to be an array.",ETTLTYPE:"The ttl argument has to be a number."},o}.call(this)}).call(ys)});var Kr=R((Is,vs)=>{(function(){var t;t=vs.exports=Rs(),t.version="5.1.2"}).call(Is)});var mt=R((hd,Ls)=>{var $a="2.0.0",Fa=Number.MAX_SAFE_INTEGER||9007199254740991,Ua=16,qa=250,Ma=["major","premajor","minor","preminor","patch","prepatch","prerelease"];Ls.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:Ua,MAX_SAFE_BUILD_LENGTH:qa,MAX_SAFE_INTEGER:Fa,RELEASE_TYPES:Ma,SEMVER_SPEC_VERSION:$a,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var ht=R((gd,ws)=>{var Ba=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};ws.exports=Ba});var Me=R((Ee,Ss)=>{var{MAX_SAFE_COMPONENT_LENGTH:Qr,MAX_SAFE_BUILD_LENGTH:Wa,MAX_LENGTH:Ha}=mt(),ja=ht();Ee=Ss.exports={};var Ga=Ee.re=[],Xa=Ee.safeRe=[],g=Ee.src=[],E=Ee.t={},Ka=0,Zr="[a-zA-Z0-9-]",Ya=[["\\s",1],["\\d",Ha],[Zr,Wa]],Ja=t=>{for(let[e,r]of Ya)t=t.split(`${e}*`).join(`${e}{0,${r}}`).split(`${e}+`).join(`${e}{1,${r}}`);return t},x=(t,e,r)=>{let n=Ja(e),s=Ka++;ja(t,s,e),E[t]=s,g[s]=e,Ga[s]=new RegExp(e,r?"g":void 0),Xa[s]=new RegExp(n,r?"g":void 0)};x("NUMERICIDENTIFIER","0|[1-9]\\d*");x("NUMERICIDENTIFIERLOOSE","\\d+");x("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Zr}*`);x("MAINVERSION",`(${g[E.NUMERICIDENTIFIER]})\\.(${g[E.NUMERICIDENTIFIER]})\\.(${g[E.NUMERICIDENTIFIER]})`);x("MAINVERSIONLOOSE",`(${g[E.NUMERICIDENTIFIERLOOSE]})\\.(${g[E.NUMERICIDENTIFIERLOOSE]})\\.(${g[E.NUMERICIDENTIFIERLOOSE]})`);x("PRERELEASEIDENTIFIER",`(?:${g[E.NUMERICIDENTIFIER]}|${g[E.NONNUMERICIDENTIFIER]})`);x("PRERELEASEIDENTIFIERLOOSE",`(?:${g[E.NUMERICIDENTIFIERLOOSE]}|${g[E.NONNUMERICIDENTIFIER]})`);x("PRERELEASE",`(?:-(${g[E.PRERELEASEIDENTIFIER]}(?:\\.${g[E.PRERELEASEIDENTIFIER]})*))`);x("PRERELEASELOOSE",`(?:-?(${g[E.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${g[E.PRERELEASEIDENTIFIERLOOSE]})*))`);x("BUILDIDENTIFIER",`${Zr}+`);x("BUILD",`(?:\\+(${g[E.BUILDIDENTIFIER]}(?:\\.${g[E.BUILDIDENTIFIER]})*))`);x("FULLPLAIN",`v?${g[E.MAINVERSION]}${g[E.PRERELEASE]}?${g[E.BUILD]}?`);x("FULL",`^${g[E.FULLPLAIN]}$`);x("LOOSEPLAIN",`[v=\\s]*${g[E.MAINVERSIONLOOSE]}${g[E.PRERELEASELOOSE]}?${g[E.BUILD]}?`);x("LOOSE",`^${g[E.LOOSEPLAIN]}$`);x("GTLT","((?:<|>)?=?)");x("XRANGEIDENTIFIERLOOSE",`${g[E.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);x("XRANGEIDENTIFIER",`${g[E.NUMERICIDENTIFIER]}|x|X|\\*`);x("XRANGEPLAIN",`[v=\\s]*(${g[E.XRANGEIDENTIFIER]})(?:\\.(${g[E.XRANGEIDENTIFIER]})(?:\\.(${g[E.XRANGEIDENTIFIER]})(?:${g[E.PRERELEASE]})?${g[E.BUILD]}?)?)?`);x("XRANGEPLAINLOOSE",`[v=\\s]*(${g[E.XRANGEIDENTIFIERLOOSE]})(?:\\.(${g[E.XRANGEIDENTIFIERLOOSE]})(?:\\.(${g[E.XRANGEIDENTIFIERLOOSE]})(?:${g[E.PRERELEASELOOSE]})?${g[E.BUILD]}?)?)?`);x("XRANGE",`^${g[E.GTLT]}\\s*${g[E.XRANGEPLAIN]}$`);x("XRANGELOOSE",`^${g[E.GTLT]}\\s*${g[E.XRANGEPLAINLOOSE]}$`);x("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Qr}})(?:\\.(\\d{1,${Qr}}))?(?:\\.(\\d{1,${Qr}}))?`);x("COERCE",`${g[E.COERCEPLAIN]}(?:$|[^\\d])`);x("COERCEFULL",g[E.COERCEPLAIN]+`(?:${g[E.PRERELEASE]})?(?:${g[E.BUILD]})?(?:$|[^\\d])`);x("COERCERTL",g[E.COERCE],!0);x("COERCERTLFULL",g[E.COERCEFULL],!0);x("LONETILDE","(?:~>?)");x("TILDETRIM",`(\\s*)${g[E.LONETILDE]}\\s+`,!0);Ee.tildeTrimReplace="$1~";x("TILDE",`^${g[E.LONETILDE]}${g[E.XRANGEPLAIN]}$`);x("TILDELOOSE",`^${g[E.LONETILDE]}${g[E.XRANGEPLAINLOOSE]}$`);x("LONECARET","(?:\\^)");x("CARETTRIM",`(\\s*)${g[E.LONECARET]}\\s+`,!0);Ee.caretTrimReplace="$1^";x("CARET",`^${g[E.LONECARET]}${g[E.XRANGEPLAIN]}$`);x("CARETLOOSE",`^${g[E.LONECARET]}${g[E.XRANGEPLAINLOOSE]}$`);x("COMPARATORLOOSE",`^${g[E.GTLT]}\\s*(${g[E.LOOSEPLAIN]})$|^$`);x("COMPARATOR",`^${g[E.GTLT]}\\s*(${g[E.FULLPLAIN]})$|^$`);x("COMPARATORTRIM",`(\\s*)${g[E.GTLT]}\\s*(${g[E.LOOSEPLAIN]}|${g[E.XRANGEPLAIN]})`,!0);Ee.comparatorTrimReplace="$1$2$3";x("HYPHENRANGE",`^\\s*(${g[E.XRANGEPLAIN]})\\s+-\\s+(${g[E.XRANGEPLAIN]})\\s*$`);x("HYPHENRANGELOOSE",`^\\s*(${g[E.XRANGEPLAINLOOSE]})\\s+-\\s+(${g[E.XRANGEPLAINLOOSE]})\\s*$`);x("STAR","(<|>)?=?\\s*\\*");x("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");x("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var Xt=R((Ed,Ns)=>{var za=Object.freeze({loose:!0}),Qa=Object.freeze({}),Za=t=>t?typeof t!="object"?za:t:Qa;Ns.exports=Za});var en=R((yd,Cs)=>{var Os=/^[0-9]+$/,_s=(t,e)=>{let r=Os.test(t),n=Os.test(e);return r&&n&&(t=+t,e=+e),t===e?0:r&&!n?-1:n&&!r?1:t<e?-1:1},ec=(t,e)=>_s(e,t);Cs.exports={compareIdentifiers:_s,rcompareIdentifiers:ec}});var G=R((bd,Vs)=>{var Kt=ht(),{MAX_LENGTH:ks,MAX_SAFE_INTEGER:Yt}=mt(),{safeRe:As,t:Ds}=Me(),tc=Xt(),{compareIdentifiers:Be}=en(),tn=class t{constructor(e,r){if(r=tc(r),e instanceof t){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>ks)throw new TypeError(`version is longer than ${ks} characters`);Kt("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let n=e.trim().match(r.loose?As[Ds.LOOSE]:As[Ds.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>Yt||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Yt||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Yt||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(s=>{if(/^[0-9]+$/.test(s)){let i=+s;if(i>=0&&i<Yt)return i}return s}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Kt("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if(typeof e=="string"&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof t||(e=new t(e,this.options)),Be(this.major,e.major)||Be(this.minor,e.minor)||Be(this.patch,e.patch)}comparePre(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{let n=this.prerelease[r],s=e.prerelease[r];if(Kt("prerelease compare",r,n,s),n===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(n===void 0)return-1;if(n===s)continue;return Be(n,s)}while(++r)}compareBuild(e){e instanceof t||(e=new t(e,this.options));let r=0;do{let n=this.build[r],s=e.build[r];if(Kt("build compare",r,n,s),n===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(n===void 0)return-1;if(n===s)continue;return Be(n,s)}while(++r)}inc(e,r,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,n),this.inc("pre",r,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,n),this.inc("pre",r,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let s=Number(n)?1:0;if(!r&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[s];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(r===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(s)}}if(r){let i=[r,s];n===!1&&(i=[r]),Be(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};Vs.exports=tn});var Te=R((Rd,Fs)=>{var $s=G(),rc=(t,e,r=!1)=>{if(t instanceof $s)return t;try{return new $s(t,e)}catch(n){if(!r)return null;throw n}};Fs.exports=rc});var qs=R((Id,Us)=>{var nc=Te(),sc=(t,e)=>{let r=nc(t,e);return r?r.version:null};Us.exports=sc});var Bs=R((vd,Ms)=>{var ic=Te(),oc=(t,e)=>{let r=ic(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null};Ms.exports=oc});var js=R((xd,Hs)=>{var Ws=G(),ac=(t,e,r,n,s)=>{typeof r=="string"&&(s=n,n=r,r=void 0);try{return new Ws(t instanceof Ws?t.version:t,r).inc(e,n,s).version}catch{return null}};Hs.exports=ac});var Ks=R((Pd,Xs)=>{var Gs=Te(),cc=(t,e)=>{let r=Gs(t,null,!0),n=Gs(e,null,!0),s=r.compare(n);if(s===0)return null;let i=s>0,o=i?r:n,c=i?n:r,a=!!o.prerelease.length;if(!!c.prerelease.length&&!a)return!c.patch&&!c.minor?"major":o.patch?"patch":o.minor?"minor":"major";let u=a?"pre":"";return r.major!==n.major?u+"major":r.minor!==n.minor?u+"minor":r.patch!==n.patch?u+"patch":"prerelease"};Xs.exports=cc});var Js=R((Td,Ys)=>{var lc=G(),uc=(t,e)=>new lc(t,e).major;Ys.exports=uc});var Qs=R((Ld,zs)=>{var pc=G(),fc=(t,e)=>new pc(t,e).minor;zs.exports=fc});var ei=R((wd,Zs)=>{var dc=G(),mc=(t,e)=>new dc(t,e).patch;Zs.exports=mc});var ri=R((Sd,ti)=>{var hc=Te(),gc=(t,e)=>{let r=hc(t,e);return r&&r.prerelease.length?r.prerelease:null};ti.exports=gc});var ae=R((Nd,si)=>{var ni=G(),Ec=(t,e,r)=>new ni(t,r).compare(new ni(e,r));si.exports=Ec});var oi=R((Od,ii)=>{var yc=ae(),bc=(t,e,r)=>yc(e,t,r);ii.exports=bc});var ci=R((_d,ai)=>{var Rc=ae(),Ic=(t,e)=>Rc(t,e,!0);ai.exports=Ic});var Jt=R((Cd,ui)=>{var li=G(),vc=(t,e,r)=>{let n=new li(t,r),s=new li(e,r);return n.compare(s)||n.compareBuild(s)};ui.exports=vc});var fi=R((kd,pi)=>{var xc=Jt(),Pc=(t,e)=>t.sort((r,n)=>xc(r,n,e));pi.exports=Pc});var mi=R((Ad,di)=>{var Tc=Jt(),Lc=(t,e)=>t.sort((r,n)=>Tc(n,r,e));di.exports=Lc});var gt=R((Dd,hi)=>{var wc=ae(),Sc=(t,e,r)=>wc(t,e,r)>0;hi.exports=Sc});var zt=R((Vd,gi)=>{var Nc=ae(),Oc=(t,e,r)=>Nc(t,e,r)<0;gi.exports=Oc});var rn=R(($d,Ei)=>{var _c=ae(),Cc=(t,e,r)=>_c(t,e,r)===0;Ei.exports=Cc});var nn=R((Fd,yi)=>{var kc=ae(),Ac=(t,e,r)=>kc(t,e,r)!==0;yi.exports=Ac});var Qt=R((Ud,bi)=>{var Dc=ae(),Vc=(t,e,r)=>Dc(t,e,r)>=0;bi.exports=Vc});var Zt=R((qd,Ri)=>{var $c=ae(),Fc=(t,e,r)=>$c(t,e,r)<=0;Ri.exports=Fc});var sn=R((Md,Ii)=>{var Uc=rn(),qc=nn(),Mc=gt(),Bc=Qt(),Wc=zt(),Hc=Zt(),jc=(t,e,r,n)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return Uc(t,r,n);case"!=":return qc(t,r,n);case">":return Mc(t,r,n);case">=":return Bc(t,r,n);case"<":return Wc(t,r,n);case"<=":return Hc(t,r,n);default:throw new TypeError(`Invalid operator: ${e}`)}};Ii.exports=jc});var xi=R((Bd,vi)=>{var Gc=G(),Xc=Te(),{safeRe:er,t:tr}=Me(),Kc=(t,e)=>{if(t instanceof Gc)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};let r=null;if(!e.rtl)r=t.match(e.includePrerelease?er[tr.COERCEFULL]:er[tr.COERCE]);else{let a=e.includePrerelease?er[tr.COERCERTLFULL]:er[tr.COERCERTL],l;for(;(l=a.exec(t))&&(!r||r.index+r[0].length!==t.length);)(!r||l.index+l[0].length!==r.index+r[0].length)&&(r=l),a.lastIndex=l.index+l[1].length+l[2].length;a.lastIndex=-1}if(r===null)return null;let n=r[2],s=r[3]||"0",i=r[4]||"0",o=e.includePrerelease&&r[5]?`-${r[5]}`:"",c=e.includePrerelease&&r[6]?`+${r[6]}`:"";return Xc(`${n}.${s}.${i}${o}${c}`,e)};vi.exports=Kc});var Ti=R((Wd,Pi)=>{var on=class{constructor(){this.max=1e3,this.map=new Map}get(e){let r=this.map.get(e);if(r!==void 0)return this.map.delete(e),this.map.set(e,r),r}delete(e){return this.map.delete(e)}set(e,r){if(!this.delete(e)&&r!==void 0){if(this.map.size>=this.max){let s=this.map.keys().next().value;this.delete(s)}this.map.set(e,r)}return this}};Pi.exports=on});var ce=R((Hd,Ni)=>{var Yc=/\s+/g,an=class t{constructor(e,r){if(r=zc(r),e instanceof t)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new t(e.raw,r);if(e instanceof cn)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e.trim().replace(Yc," "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(s=>!wi(s[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let s of this.set)if(s.length===1&&sl(s[0])){this.set=[s];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let r=this.set[e];for(let n=0;n<r.length;n++)n>0&&(this.formatted+=" "),this.formatted+=r[n].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&rl)|(this.options.loose&&nl))+":"+e,s=Li.get(n);if(s)return s;let i=this.options.loose,o=i?Z[J.HYPHENRANGELOOSE]:Z[J.HYPHENRANGE];e=e.replace(o,ml(this.options.includePrerelease)),N("hyphen replace",e),e=e.replace(Z[J.COMPARATORTRIM],Zc),N("comparator trim",e),e=e.replace(Z[J.TILDETRIM],el),N("tilde trim",e),e=e.replace(Z[J.CARETTRIM],tl),N("caret trim",e);let c=e.split(" ").map(p=>il(p,this.options)).join(" ").split(/\s+/).map(p=>dl(p,this.options));i&&(c=c.filter(p=>(N("loose invalid filter",p,this.options),!!p.match(Z[J.COMPARATORLOOSE])))),N("range list",c);let a=new Map,l=c.map(p=>new cn(p,this.options));for(let p of l){if(wi(p))return[p];a.set(p.value,p)}a.size>1&&a.has("")&&a.delete("");let u=[...a.values()];return Li.set(n,u),u}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some(n=>Si(n,r)&&e.set.some(s=>Si(s,r)&&n.every(i=>s.every(o=>i.intersects(o,r)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new Qc(e,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if(hl(this.set[r],e,this.options))return!0;return!1}};Ni.exports=an;var Jc=Ti(),Li=new Jc,zc=Xt(),cn=Et(),N=ht(),Qc=G(),{safeRe:Z,t:J,comparatorTrimReplace:Zc,tildeTrimReplace:el,caretTrimReplace:tl}=Me(),{FLAG_INCLUDE_PRERELEASE:rl,FLAG_LOOSE:nl}=mt(),wi=t=>t.value==="<0.0.0-0",sl=t=>t.value==="",Si=(t,e)=>{let r=!0,n=t.slice(),s=n.pop();for(;r&&n.length;)r=n.every(i=>s.intersects(i,e)),s=n.pop();return r},il=(t,e)=>(N("comp",t,e),t=cl(t,e),N("caret",t),t=ol(t,e),N("tildes",t),t=ul(t,e),N("xrange",t),t=fl(t,e),N("stars",t),t),z=t=>!t||t.toLowerCase()==="x"||t==="*",ol=(t,e)=>t.trim().split(/\s+/).map(r=>al(r,e)).join(" "),al=(t,e)=>{let r=e.loose?Z[J.TILDELOOSE]:Z[J.TILDE];return t.replace(r,(n,s,i,o,c)=>{N("tilde",t,n,s,i,o,c);let a;return z(s)?a="":z(i)?a=`>=${s}.0.0 <${+s+1}.0.0-0`:z(o)?a=`>=${s}.${i}.0 <${s}.${+i+1}.0-0`:c?(N("replaceTilde pr",c),a=`>=${s}.${i}.${o}-${c} <${s}.${+i+1}.0-0`):a=`>=${s}.${i}.${o} <${s}.${+i+1}.0-0`,N("tilde return",a),a})},cl=(t,e)=>t.trim().split(/\s+/).map(r=>ll(r,e)).join(" "),ll=(t,e)=>{N("caret",t,e);let r=e.loose?Z[J.CARETLOOSE]:Z[J.CARET],n=e.includePrerelease?"-0":"";return t.replace(r,(s,i,o,c,a)=>{N("caret",t,s,i,o,c,a);let l;return z(i)?l="":z(o)?l=`>=${i}.0.0${n} <${+i+1}.0.0-0`:z(c)?i==="0"?l=`>=${i}.${o}.0${n} <${i}.${+o+1}.0-0`:l=`>=${i}.${o}.0${n} <${+i+1}.0.0-0`:a?(N("replaceCaret pr",a),i==="0"?o==="0"?l=`>=${i}.${o}.${c}-${a} <${i}.${o}.${+c+1}-0`:l=`>=${i}.${o}.${c}-${a} <${i}.${+o+1}.0-0`:l=`>=${i}.${o}.${c}-${a} <${+i+1}.0.0-0`):(N("no pr"),i==="0"?o==="0"?l=`>=${i}.${o}.${c}${n} <${i}.${o}.${+c+1}-0`:l=`>=${i}.${o}.${c}${n} <${i}.${+o+1}.0-0`:l=`>=${i}.${o}.${c} <${+i+1}.0.0-0`),N("caret return",l),l})},ul=(t,e)=>(N("replaceXRanges",t,e),t.split(/\s+/).map(r=>pl(r,e)).join(" ")),pl=(t,e)=>{t=t.trim();let r=e.loose?Z[J.XRANGELOOSE]:Z[J.XRANGE];return t.replace(r,(n,s,i,o,c,a)=>{N("xRange",t,n,s,i,o,c,a);let l=z(i),u=l||z(o),p=u||z(c),d=p;return s==="="&&d&&(s=""),a=e.includePrerelease?"-0":"",l?s===">"||s==="<"?n="<0.0.0-0":n="*":s&&d?(u&&(o=0),c=0,s===">"?(s=">=",u?(i=+i+1,o=0,c=0):(o=+o+1,c=0)):s==="<="&&(s="<",u?i=+i+1:o=+o+1),s==="<"&&(a="-0"),n=`${s+i}.${o}.${c}${a}`):u?n=`>=${i}.0.0${a} <${+i+1}.0.0-0`:p&&(n=`>=${i}.${o}.0${a} <${i}.${+o+1}.0-0`),N("xRange return",n),n})},fl=(t,e)=>(N("replaceStars",t,e),t.trim().replace(Z[J.STAR],"")),dl=(t,e)=>(N("replaceGTE0",t,e),t.trim().replace(Z[e.includePrerelease?J.GTE0PRE:J.GTE0],"")),ml=t=>(e,r,n,s,i,o,c,a,l,u,p,d)=>(z(n)?r="":z(s)?r=`>=${n}.0.0${t?"-0":""}`:z(i)?r=`>=${n}.${s}.0${t?"-0":""}`:o?r=`>=${r}`:r=`>=${r}${t?"-0":""}`,z(l)?a="":z(u)?a=`<${+l+1}.0.0-0`:z(p)?a=`<${l}.${+u+1}.0-0`:d?a=`<=${l}.${u}.${p}-${d}`:t?a=`<${l}.${u}.${+p+1}-0`:a=`<=${a}`,`${r} ${a}`.trim()),hl=(t,e,r)=>{for(let n=0;n<t.length;n++)if(!t[n].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(let n=0;n<t.length;n++)if(N(t[n].semver),t[n].semver!==cn.ANY&&t[n].semver.prerelease.length>0){let s=t[n].semver;if(s.major===e.major&&s.minor===e.minor&&s.patch===e.patch)return!0}return!1}return!0}});var Et=R((jd,Di)=>{var yt=Symbol("SemVer ANY"),pn=class t{static get ANY(){return yt}constructor(e,r){if(r=Oi(r),e instanceof t){if(e.loose===!!r.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),un("comparator",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===yt?this.value="":this.value=this.operator+this.semver.version,un("comp",this)}parse(e){let r=this.options.loose?_i[Ci.COMPARATORLOOSE]:_i[Ci.COMPARATOR],n=e.match(r);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new ki(n[2],this.options.loose):this.semver=yt}toString(){return this.value}test(e){if(un("Comparator.test",e,this.options.loose),this.semver===yt||e===yt)return!0;if(typeof e=="string")try{e=new ki(e,this.options)}catch{return!1}return ln(e,this.operator,this.semver,this.options)}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new Ai(e.value,r).test(this.value):e.operator===""?e.value===""?!0:new Ai(this.value,r).test(e.semver):(r=Oi(r),r.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||ln(this.semver,"<",e.semver,r)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||ln(this.semver,">",e.semver,r)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};Di.exports=pn;var Oi=Xt(),{safeRe:_i,t:Ci}=Me(),ln=sn(),un=ht(),ki=G(),Ai=ce()});var bt=R((Gd,Vi)=>{var gl=ce(),El=(t,e,r)=>{try{e=new gl(e,r)}catch{return!1}return e.test(t)};Vi.exports=El});var Fi=R((Xd,$i)=>{var yl=ce(),bl=(t,e)=>new yl(t,e).set.map(r=>r.map(n=>n.value).join(" ").trim().split(" "));$i.exports=bl});var qi=R((Kd,Ui)=>{var Rl=G(),Il=ce(),vl=(t,e,r)=>{let n=null,s=null,i=null;try{i=new Il(e,r)}catch{return null}return t.forEach(o=>{i.test(o)&&(!n||s.compare(o)===-1)&&(n=o,s=new Rl(n,r))}),n};Ui.exports=vl});var Bi=R((Yd,Mi)=>{var xl=G(),Pl=ce(),Tl=(t,e,r)=>{let n=null,s=null,i=null;try{i=new Pl(e,r)}catch{return null}return t.forEach(o=>{i.test(o)&&(!n||s.compare(o)===1)&&(n=o,s=new xl(n,r))}),n};Mi.exports=Tl});var ji=R((Jd,Hi)=>{var fn=G(),Ll=ce(),Wi=gt(),wl=(t,e)=>{t=new Ll(t,e);let r=new fn("0.0.0");if(t.test(r)||(r=new fn("0.0.0-0"),t.test(r)))return r;r=null;for(let n=0;n<t.set.length;++n){let s=t.set[n],i=null;s.forEach(o=>{let c=new fn(o.semver.version);switch(o.operator){case">":c.prerelease.length===0?c.patch++:c.prerelease.push(0),c.raw=c.format();case"":case">=":(!i||Wi(c,i))&&(i=c);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),i&&(!r||Wi(r,i))&&(r=i)}return r&&t.test(r)?r:null};Hi.exports=wl});var Xi=R((zd,Gi)=>{var Sl=ce(),Nl=(t,e)=>{try{return new Sl(t,e).range||"*"}catch{return null}};Gi.exports=Nl});var rr=R((Qd,zi)=>{var Ol=G(),Ji=Et(),{ANY:_l}=Ji,Cl=ce(),kl=bt(),Ki=gt(),Yi=zt(),Al=Zt(),Dl=Qt(),Vl=(t,e,r,n)=>{t=new Ol(t,n),e=new Cl(e,n);let s,i,o,c,a;switch(r){case">":s=Ki,i=Al,o=Yi,c=">",a=">=";break;case"<":s=Yi,i=Dl,o=Ki,c="<",a="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(kl(t,e,n))return!1;for(let l=0;l<e.set.length;++l){let u=e.set[l],p=null,d=null;if(u.forEach(m=>{m.semver===_l&&(m=new Ji(">=0.0.0")),p=p||m,d=d||m,s(m.semver,p.semver,n)?p=m:o(m.semver,d.semver,n)&&(d=m)}),p.operator===c||p.operator===a||(!d.operator||d.operator===c)&&i(t,d.semver))return!1;if(d.operator===a&&o(t,d.semver))return!1}return!0};zi.exports=Vl});var Zi=R((Zd,Qi)=>{var $l=rr(),Fl=(t,e,r)=>$l(t,e,">",r);Qi.exports=Fl});var to=R((em,eo)=>{var Ul=rr(),ql=(t,e,r)=>Ul(t,e,"<",r);eo.exports=ql});var so=R((tm,no)=>{var ro=ce(),Ml=(t,e,r)=>(t=new ro(t,r),e=new ro(e,r),t.intersects(e,r));no.exports=Ml});var oo=R((rm,io)=>{var Bl=bt(),Wl=ae();io.exports=(t,e,r)=>{let n=[],s=null,i=null,o=t.sort((u,p)=>Wl(u,p,r));for(let u of o)Bl(u,e,r)?(i=u,s||(s=u)):(i&&n.push([s,i]),i=null,s=null);s&&n.push([s,null]);let c=[];for(let[u,p]of n)u===p?c.push(u):!p&&u===o[0]?c.push("*"):p?u===o[0]?c.push(`<=${p}`):c.push(`${u} - ${p}`):c.push(`>=${u}`);let a=c.join(" || "),l=typeof e.raw=="string"?e.raw:String(e);return a.length<l.length?a:e}});var fo=R((nm,po)=>{var ao=ce(),mn=Et(),{ANY:dn}=mn,Rt=bt(),hn=ae(),Hl=(t,e,r={})=>{if(t===e)return!0;t=new ao(t,r),e=new ao(e,r);let n=!1;e:for(let s of t.set){for(let i of e.set){let o=Gl(s,i,r);if(n=n||o!==null,o)continue e}if(n)return!1}return!0},jl=[new mn(">=0.0.0-0")],co=[new mn(">=0.0.0")],Gl=(t,e,r)=>{if(t===e)return!0;if(t.length===1&&t[0].semver===dn){if(e.length===1&&e[0].semver===dn)return!0;r.includePrerelease?t=jl:t=co}if(e.length===1&&e[0].semver===dn){if(r.includePrerelease)return!0;e=co}let n=new Set,s,i;for(let m of t)m.operator===">"||m.operator===">="?s=lo(s,m,r):m.operator==="<"||m.operator==="<="?i=uo(i,m,r):n.add(m.semver);if(n.size>1)return null;let o;if(s&&i){if(o=hn(s.semver,i.semver,r),o>0)return null;if(o===0&&(s.operator!==">="||i.operator!=="<="))return null}for(let m of n){if(s&&!Rt(m,String(s),r)||i&&!Rt(m,String(i),r))return null;for(let b of e)if(!Rt(m,String(b),r))return!1;return!0}let c,a,l,u,p=i&&!r.includePrerelease&&i.semver.prerelease.length?i.semver:!1,d=s&&!r.includePrerelease&&s.semver.prerelease.length?s.semver:!1;p&&p.prerelease.length===1&&i.operator==="<"&&p.prerelease[0]===0&&(p=!1);for(let m of e){if(u=u||m.operator===">"||m.operator===">=",l=l||m.operator==="<"||m.operator==="<=",s){if(d&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===d.major&&m.semver.minor===d.minor&&m.semver.patch===d.patch&&(d=!1),m.operator===">"||m.operator===">="){if(c=lo(s,m,r),c===m&&c!==s)return!1}else if(s.operator===">="&&!Rt(s.semver,String(m),r))return!1}if(i){if(p&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===p.major&&m.semver.minor===p.minor&&m.semver.patch===p.patch&&(p=!1),m.operator==="<"||m.operator==="<="){if(a=uo(i,m,r),a===m&&a!==i)return!1}else if(i.operator==="<="&&!Rt(i.semver,String(m),r))return!1}if(!m.operator&&(i||s)&&o!==0)return!1}return!(s&&l&&!i&&o!==0||i&&u&&!s&&o!==0||d||p)},lo=(t,e,r)=>{if(!t)return e;let n=hn(t.semver,e.semver,r);return n>0?t:n<0||e.operator===">"&&t.operator===">="?e:t},uo=(t,e,r)=>{if(!t)return e;let n=hn(t.semver,e.semver,r);return n<0?t:n>0||e.operator==="<"&&t.operator==="<="?e:t};po.exports=Hl});var It=R((sm,go)=>{var gn=Me(),mo=mt(),Xl=G(),ho=en(),Kl=Te(),Yl=qs(),Jl=Bs(),zl=js(),Ql=Ks(),Zl=Js(),eu=Qs(),tu=ei(),ru=ri(),nu=ae(),su=oi(),iu=ci(),ou=Jt(),au=fi(),cu=mi(),lu=gt(),uu=zt(),pu=rn(),fu=nn(),du=Qt(),mu=Zt(),hu=sn(),gu=xi(),Eu=Et(),yu=ce(),bu=bt(),Ru=Fi(),Iu=qi(),vu=Bi(),xu=ji(),Pu=Xi(),Tu=rr(),Lu=Zi(),wu=to(),Su=so(),Nu=oo(),Ou=fo();go.exports={parse:Kl,valid:Yl,clean:Jl,inc:zl,diff:Ql,major:Zl,minor:eu,patch:tu,prerelease:ru,compare:nu,rcompare:su,compareLoose:iu,compareBuild:ou,sort:au,rsort:cu,gt:lu,lt:uu,eq:pu,neq:fu,gte:du,lte:mu,cmp:hu,coerce:gu,Comparator:Eu,Range:yu,satisfies:bu,toComparators:Ru,maxSatisfying:Iu,minSatisfying:vu,minVersion:xu,validRange:Pu,outside:Tu,gtr:Lu,ltr:wu,intersects:Su,simplifyRange:Nu,subset:Ou,SemVer:Xl,re:gn.re,src:gn.src,tokens:gn.t,SEMVER_SPEC_VERSION:mo.SEMVER_SPEC_VERSION,RELEASE_TYPES:mo.RELEASE_TYPES,compareIdentifiers:ho.compareIdentifiers,rcompareIdentifiers:ho.rcompareIdentifiers}});var wf={};va(wf,{Logger:()=>P,activate:()=>Pf,deactivate:()=>Tf});module.exports=xa(wf);var H=require("vscode");var Vt=require("vscode");var Mr=require("vscode"),ne="dependi.";var be=(n=>(n[n.Exclude=0]="Exclude",n[n.IncludeAlways=1]="IncludeAlways",n[n.IncludeIfUnstable=2]="IncludeIfUnstable",n))(be||{}),L=(h=>(h.RUST_ENABLED="rust.enabled",h.RUST_INDEX_SERVER_URL="rust.indexServerURL",h.RUST_UNSTABLE_FILTER="rust.unstableFilter",h.RUST_IGNORE_LINE_PATTERN="rust.ignoreLinePattern",h.RUST_INFORM_PATCH_UPDATES="rust.informPatchUpdates",h.RUST_ENABLED_LOCK_FILE="rust.lockFileEnabled",h.RUST_SILENCE_VERSION_OVERFLOWS="rust.silenceVersionOverflows",h.NPM_ENABLED="npm.enabled",h.NPM_INDEX_SERVER_URL="npm.indexServerURL",h.NPM_UNSTABLE_FILTER="npm.unstableFilter",h.NPM_IGNORE_LINE_PATTERN="npm.ignoreLinePattern",h.NPM_INFORM_PATCH_UPDATES="npm.informPatchUpdates",h.NPM_ENABLED_LOCK_FILE="npm.lockFileEnabled",h.NPM_SILENCE_VERSION_OVERFLOWS="npm.silenceVersionOverflows",h.NPM_JSR_ENABLED="npm.jsrEnabled",h.NPM_JSR_INDEX_SERVER_URL="npm.jsrIndexServerURL",h.PHP_ENABLED="php.enabled",h.PHP_INDEX_SERVER_URL="php.indexServerURL",h.PHP_UNSTABLE_FILTER="php.unstableFilter",h.PHP_IGNORE_LINE_PATTERN="php.ignoreLinePattern",h.PHP_INFORM_PATCH_UPDATES="php.informPatchUpdates",h.PHP_ENABLED_LOCK_FILE="php.lockFileEnabled",h.PHP_SILENCE_VERSION_OVERFLOWS="php.silenceVersionOverflows",h.GO_ENABLED="go.enabled",h.GO_INDEX_SERVER_URL="go.indexServerURL",h.GO_UNSTABLE_FILTER="go.unstableFilter",h.GO_IGNORE_LINE_PATTERN="go.ignoreLinePattern",h.GO_INFORM_PATCH_UPDATES="go.informPatchUpdates",h.GO_SILENCE_VERSION_OVERFLOWS="go.silenceVersionOverflows",h.PYTHON_ENABLED="python.enabled",h.PYTHON_INDEX_SERVER_URL="python.indexServerURL",h.PYTHON_UNSTABLE_FILTER="python.unstableFilter",h.PYTHON_IGNORE_LINE_PATTERN="python.ignoreLinePattern",h.PYTHON_INFORM_PATCH_UPDATES="python.informPatchUpdates",h.PYTHON_ENABLED_LOCK_FILE="python.lockFileEnabled",h.PYTHON_SILENCE_VERSION_OVERFLOWS="python.silenceVersionOverflows",h.DART_ENABLED="dart.enabled",h.DART_INDEX_SERVER_URL="dart.indexServerURL",h.DART_UNSTABLE_FILTER="dart.unstableFilter",h.DART_IGNORE_LINE_PATTERN="dart.ignoreLinePattern",h.DART_INFORM_PATCH_UPDATES="dart.informPatchUpdates",h.DART_ENABLED_LOCK_FILE="dart.lockFileEnabled",h.DART_SILENCE_VERSION_OVERFLOWS="dart.silenceVersionOverflows",h.CSHARP_ENABLED="csharp.enabled",h.CSHARP_INDEX_SERVER_URL="csharp.indexServerURL",h.CSHARP_UNSTABLE_FILTER="csharp.unstableFilter",h.CSHARP_IGNORE_LINE_PATTERN="csharp.ignoreLinePattern",h.CSHARP_INFORM_PATCH_UPDATES="csharp.informPatchUpdates",h.CSHARP_ENABLED_LOCK_FILE="csharp.lockFileEnabled",h.CSHARP_SILENCE_VERSION_OVERFLOWS="csharp.silenceVersionOverflows",h.VULS_ENABLED="vulnerability.enabled",h.VULS_GHSA_ENABLED="vulnerability.ghsa.enabled",h.VULS_OSV_BATCH_URL="vulnerability.osvQueryURL.batch",h.VULS_OSV_URL="vulnerability.osvQueryURL.single",h.INDEX_SERVER_API_KEY="apiKey",h.INDEX_SERVER_URL="apiURL",h.DECORATOR_POSITION="decoration.position",h.ERROR_DECORATOR="decoration.error.template",h.ERROR_DECORATOR_CSS="decoration.error.style",h.INCOMPATIBLE_DECORATOR="decoration.incompatible.template",h.INCOMPATIBLE_DECORATOR_CSS="decoration.incompatible.style",h.PATCH_UPDATE_DECORATOR="decoration.patchUpdate.template",h.PATCH_UPDATE_DECORATOR_CSS="decoration.patchUpdate.style",h.COMPATIBLE_DECORATOR="decoration.compatible.template",h.COMPATIBLE_DECORATOR_CSS="decoration.compatible.style",h.VULNERABILITY_DECORATOR="decoration.vulnerability.template",h.REPLACE_VERSIONS=`${ne}commands.replaceVersion`,h.GENERATE_VULNERABILITY_REPORT=`${ne}commands.vulnerability.report`,h.GENERATE_VULNERABILITY_CURRENT_REPORT=`${ne}commands.vulnerability.currentReport`,h.UPDATE_ALL=`${ne}commands.updateAll`,h.RETRY=`${ne}commands.retry`,h.ENABLE_LOCK_FILE_PARSING=`${ne}commands.enableLockFileParsing`,h.DISABLE_LOCK_FILE_PARSING=`${ne}commands.disableLockFileParsing`,h.LOCK_FILE_PARSED=`${ne}commands.lockFileParsed`,h.SILENCE_UPDATE_MESSAGES="extras.silenceUpdateMessages",h.DEVICE_ID=`${ne}deviceID`,h.SHOWN_VERSION=`${ne}shownVersion`,h.RUST_UNSTABLE_OLD="rust.excludeUnstableVersions",h.NPM_UNSTABLE_OLD="npm.excludeUnstableVersions",h.PHP_UNSTABLE_OLD="php.excludeUnstableVersions",h.GO_UNSTABLE_OLD="go.excludeUnstableVersions",h.PYTHON_UNSTABLE_OLD="python.excludeUnstableVersions",h))(L||{}),f={version:"0.0.1",rust:{enabled:!0,index:"",unstableFilter:0,ignoreLinePattern:"",informPatchUpdates:!1,lockFileEnabled:!0,silenceVersionOverflows:!1},npm:{enabled:!0,index:"",unstableFilter:0,ignoreLinePattern:"",informPatchUpdates:!1,lockFileEnabled:!0,silenceVersionOverflows:!1,jsrEnabled:!0,jsrIndex:""},php:{enabled:!0,index:"",unstableFilter:0,ignoreLinePattern:"",informPatchUpdates:!1,lockFileEnabled:!0,silenceVersionOverflows:!1},go:{enabled:!0,index:"",unstableFilter:0,ignoreLinePattern:"",informPatchUpdates:!0,silenceVersionOverflows:!1},python:{enabled:!0,index:"",unstableFilter:0,ignoreLinePattern:"",informPatchUpdates:!1,lockFileEnabled:!0,silenceVersionOverflows:!1},dart:{enabled:!0,index:"",unstableFilter:0,ignoreLinePattern:"",informPatchUpdates:!1,lockFileEnabled:!0,silenceVersionOverflows:!1},csharp:{enabled:!0,index:"",unstableFilter:0,ignoreLinePattern:"",informPatchUpdates:!1,lockFileEnabled:!0,silenceVersionOverflows:!1},vulnerability:{enabled:!1,ghsa:!1,osvBatch:"",osvSingle:""},api:{key:"",url:"",proPanelURL:"https://www.dependi.io/pro",deviceID:""},decorator:{position:"",error:{template:"",css:{}},incompatible:{template:"",css:{}},patchUpdate:{template:"",css:{}},compatible:{template:"",css:{}},vulnerability:{template:""}},extras:{silenceUpdateMessages:!1},load:function(){let t=Mr.workspace.getConfiguration("dependi");console.log(this.version),this.rust.enabled=t.get("rust.enabled")??!0,this.rust.index=t.get("rust.indexServerURL")||"https://index.crates.io",this.rust.unstableFilter=dt("rust.unstableFilter","rust.excludeUnstableVersions"),this.rust.ignoreLinePattern=t.get("rust.ignoreLinePattern")||"",this.rust.informPatchUpdates=t.get("rust.informPatchUpdates")??!1,this.rust.lockFileEnabled=t.get("rust.lockFileEnabled")??!0,this.rust.silenceVersionOverflows=t.get("rust.silenceVersionOverflows")??!1,this.npm.enabled=t.get("npm.enabled")??!0,this.npm.index=t.get("npm.indexServerURL")||"https://registry.npmjs.org",this.npm.unstableFilter=dt("npm.unstableFilter","npm.excludeUnstableVersions"),this.npm.ignoreLinePattern=t.get("npm.ignoreLinePattern")||"",this.npm.informPatchUpdates=t.get("npm.informPatchUpdates")??!1,this.npm.lockFileEnabled=t.get("npm.lockFileEnabled")??!0,this.npm.silenceVersionOverflows=t.get("npm.silenceVersionOverflows")??!1,this.npm.jsrEnabled=t.get("npm.jsrEnabled")??!0,this.npm.jsrIndex=t.get("npm.jsrIndexServerURL")||"https://jsr.io",this.php.enabled=t.get("php.enabled")??!0,this.php.index=t.get("php.indexServerURL")||"https://repo.packagist.org",this.php.unstableFilter=dt("php.unstableFilter","php.excludeUnstableVersions"),this.php.ignoreLinePattern=t.get("php.ignoreLinePattern")||"",this.php.informPatchUpdates=t.get("php.informPatchUpdates")??!1,this.php.lockFileEnabled=t.get("php.lockFileEnabled")??!0,this.php.silenceVersionOverflows=t.get("php.silenceVersionOverflows")??!1,this.go.enabled=t.get("go.enabled")??!0,this.go.index=t.get("go.indexServerURL")||"https://proxy.golang.org",this.go.unstableFilter=dt("go.unstableFilter","go.excludeUnstableVersions"),this.go.ignoreLinePattern=t.get("go.ignoreLinePattern")||"",this.go.informPatchUpdates=t.get("go.informPatchUpdates")??!1,this.go.silenceVersionOverflows=t.get("go.silenceVersionOverflows")??!1,this.python.enabled=t.get("python.enabled")??!0,this.python.index=t.get("python.indexServerURL")||"https://pypi.org/pypi",this.python.unstableFilter=dt("python.unstableFilter","python.excludeUnstableVersions"),this.python.ignoreLinePattern=t.get("python.ignoreLinePattern")||"",this.python.informPatchUpdates=t.get("python.informPatchUpdates")??!1,this.python.lockFileEnabled=t.get("python.lockFileEnabled")??!0,this.python.silenceVersionOverflows=t.get("python.silenceVersionOverflows")??!1,this.dart.enabled=t.get("dart.enabled")??!0,this.dart.index=t.get("dart.indexServerURL")||"https://pub.dev",this.dart.unstableFilter=be[t.get("dart.unstableFilter")]||0,this.dart.ignoreLinePattern=t.get("dart.ignoreLinePattern")||"",this.dart.informPatchUpdates=t.get("dart.informPatchUpdates")??!1,this.dart.lockFileEnabled=t.get("dart.lockFileEnabled")??!0,this.dart.silenceVersionOverflows=t.get("dart.silenceVersionOverflows")??!1,this.csharp.enabled=t.get("csharp.enabled")??!0,this.csharp.index=t.get("csharp.indexServerURL")||"https://api.nuget.org",this.csharp.unstableFilter=be[t.get("csharp.unstableFilter")]||0,this.csharp.ignoreLinePattern=t.get("csharp.ignoreLinePattern")||"",this.csharp.informPatchUpdates=t.get("csharp.informPatchUpdates")??!1,this.csharp.lockFileEnabled=t.get("csharp.lockFileEnabled")??!0,this.csharp.silenceVersionOverflows=t.get("csharp.silenceVersionOverflows")??!1,this.vulnerability.enabled=t.get("vulnerability.enabled")??!0,this.vulnerability.ghsa=t.get("vulnerability.ghsa.enabled")??!1,this.vulnerability.osvBatch=t.get("vulnerability.osvQueryURL.batch")||"https://api.osv.dev/v1/querybatch",this.vulnerability.osvSingle=t.get("vulnerability.osvQueryURL.single")||"https://api.osv.dev/v1/query",this.api.key=t.get("apiKey")||"",this.api.url=t.get("apiURL")||"https://index.dependi.io",this.decorator.position=t.get("decoration.position")||"after",this.decorator.error.template=t.get("decoration.error.template")??"\u2757\uFE0F\u2757\uFE0F\u2757\uFE0F",this.decorator.error.css=t.get("decoration.error.style")||{},this.decorator.incompatible.template=t.get("decoration.incompatible.template")??"\u274C ${version}",this.decorator.incompatible.css=t.get("decoration.incompatible.style")||{},this.decorator.patchUpdate.template=t.get("decoration.patchUpdate.template")??"\u26A0\uFE0F ${version}",this.decorator.patchUpdate.css=t.get("decoration.patchUpdate.style")||{},this.decorator.compatible.template=t.get("decoration.compatible.template")??"\u2705",this.decorator.compatible.css=t.get("decoration.compatible.style")||{},this.decorator.vulnerability.template=t.get("decoration.vulnerability.template")??"\u{1F6A8} ${count}",this.extras.silenceUpdateMessages=t.get("extras.silenceUpdateMessages")??!1,console.debug("Settings loaded",this)},onChange:function(t){t.affectsConfiguration("dependi")&&(console.debug("Config changed"),this.load())}};function dt(t,e){let r=Mr.workspace.getConfiguration("dependi"),n=r.get(t);if(f.version>"0.7.9"){let s=r.get(e);if(s!==void 0)return r.update(e,void 0,!0),r.update(t,s?"Exclude":"IncludeAlways",!0),s?0:1}return be[n]||0}var Wo=S(require("path"));var O={inProgress:!1,updateAllData:[]};var Ue=require("vscode");var w=Ue.window.createStatusBarItem(Ue.StatusBarAlignment.Right,-1e3);w.setText=(t,e,r=!1)=>{switch(t){case"Error":if(w.color="statusBarItem.errorForeground",w.text="$(error) Dependi",r){w.tooltip=e||"Error";return}else{w.tooltip="",Ue.window.showErrorMessage(e||"Error");return}case"Warning":w.text="$(warning) Dependi",w.color="statusBarItem.warningForeground";break;case"Info":w.color="statusBarItem.foreground",w.text="$(check-all) Dependi";break;case"Loading":w.color="statusBarItem.activeForeground",w.text="$(sync~spin) Dependi"}e&&Ue.window.setStatusBarMessage(`Dependi: ${e}`,2e3),w.tooltip=e,w.command=L.RETRY};w.fetching=t=>{w.color="statusBarItem.activeForeground",w.text="$(sync~spin) Dependi",w.tooltip="\u{1F440} Fetching "+t.replace(/^https?:\/\//,""),w.command=L.RETRY};var Hr=S(require("path"));var Br=S(require("os"));function Pa(){let t=Br.default.platform(),e=Br.default.release(),r="Unknown OS";switch(t){case"win32":r="Windows",e.startsWith("10")?r+=" 10":e.startsWith("6.3")?r+=" 8.1":e.startsWith("6.2")?r+=" 8":e.startsWith("6.1")&&(r+=" 7");break;case"darwin":r="Mac OS X";let n=e.split(".").slice(0,2).join(".");r+=` ${n}`;break;case"linux":r="Linux";break;default:r=t}return r}function Ta(){return`Dependi (https://www.dependi.io) (${f.version}) - ${Pa()}`}var Wr=Ta();function q(t){let e=new URL(t);return{protocol:e.protocol,hostname:e.hostname,port:e.port,path:e.pathname+e.search,headers:{"User-Agent":Wr},timeout:1e3}}var as=S(require("zlib"));function M(t){return new Error(`statusCode=${t.statusCode}: ${t.url}`)}function B(t){return!t.statusCode||t.statusCode<200||t.statusCode>=300}function cs(t){return t.statusCode?t.statusCode>=300&&t.statusCode<400:!1}function Y(t,e,r,n){let s=[];return e.on("data",function(i){s.push(i)}),r.on("error",function(i){n(i)}),r.on("timeout",function(){r.destroy(),n(new Error(`Request to ${t} timed out`))}),s}function ls(t,e,r,n){let s=[];r.on("error",function(c){n(c)}),r.on("timeout",function(){r.destroy(),n(new Error(`Request to ${t} timed out`))});let i;return e.headers["content-encoding"]==="gzip"?i=e.pipe(as.createGunzip()):i=e,i.on("error",c=>{n(c)}),i.on("data",function(c){s.push(c)}),{body:s,stream:i}}function F(t){let e=t.replace("///","");return e.endsWith("/")&&(e=e.slice(0,-1)),e}async function Re(t,e){try{let r=await fetch(La(t),{method:"GET",credentials:"include",cache:"default",...e,headers:{Accept:"application/json","Content-Type":"application/json","User-Agent":Wr,...e?.headers}}),n,s,i=r.headers.get("Content-Type");if(r.status>0&&r.status<300)if(r.status!==204)try{i&&i.includes("application/json")?s=await r.json():i&&i.includes("text/html")?s=await r.text():i&&i.includes("application/pdf")?s=await r.blob():s=await r.text()}catch{n=await r.text()}else P.appendLine(`${t}:${e?.method||"GET"} ${r.status}-${r.statusText}`);else{if(n=await r.text(),n)try{n=JSON.parse(n),n=n.message||n.error||n}catch(o){P.appendLine(`${t}:${e?.method||"GET"} ${r.status}-${r.statusText}, ${o}, ${n}`)}console.error(t,e?.method||"GET",n,r.status,r.statusText),P.appendLine(`${t}:${e?.method||"GET"} ${r.status}-${r.statusText}, ${n}`)}return{status:r.status,statusText:r.statusText,body:s,headers:r.headers,error:n,isLoading:!1}}catch(r){return console.error(t,e?.method||"GET",r),P.appendLine(`${t}:${e?.method||"GET"} ${r}`),{status:0,statusText:"",body:void 0,headers:void 0,error:r.message||r+"",isLoading:!1}}}function La(t){return F(`${f.api.url}/${t}`)}async function us(t){t.DeviceID=f.api.deviceID,t.FileName=t.FileName.toLowerCase();let e=await Re("v1/public/telemetries",{method:"POST",headers:{"X-Device-ID":f.api.deviceID,"Content-Type":"application/json"},body:JSON.stringify(t)});return e.error&&P.appendLine(`Error sending telemetry: ${e.error}`),e}var qe=require("vscode");var y=0,jr="",Gr="crates.io";function Bt(t){if(!t){y=0;return}let e=Hr.default.basename(t),r=Hr.default.extname(e);switch(e.toLowerCase()){case"cargo.toml":return fe(1,"rust",e,"crates.io",f.rust.lockFileEnabled);case"go.mod":return fe(2,"go",e,"Go");case"package.json":return fe(3,"npm",e,"npm",f.npm.lockFileEnabled);case"pnpm-workspace.yaml":return fe(8,"npm",e,"npm");case"composer.json":return fe(5,"php",e,"Packagist",f.php.lockFileEnabled);case"pyproject.toml":return fe(4,"python",e,"PyPI",f.python.lockFileEnabled);case"pixi.toml":return fe(4,"python",e,"PyPI",f.python.lockFileEnabled);case"pubspec.yaml":return fe(6,"dart",e,"Pub");case"directory.build.props":case"directory.packages.props":return fe(7,"csharp",e,"NuGet");default:if(r===".csproj")return fe(7,"csharp",e,"NuGet");if((r===".txt"||r===".in")&&e.toLowerCase().startsWith("requirement"))return fe(4,"python",e,"PyPI",f.python.lockFileEnabled)}}function fe(t,e,r,n,s){return y=t,jr=e,Gr=n,qe.commands.executeCommand("setContext","dependi.supportedFiles",[r]),qe.env.isTelemetryEnabled&&us({FileName:r}),s!==void 0&&(qe.commands.executeCommand("setContext","dependi.hasLockFile",!1),qe.commands.executeCommand("setContext","dependi.isEnableLockParsing",s)),t}var ps=S(require("https")),Xr=S(require("http"));var W=(t,e,r,n)=>{let s=t.protocol==="http:"?Xr.default:ps,i=s.get(t,o=>{if(cs(o)&&o.headers.location){let c=F(o.headers.location),a=q(c);n&&(a.headers={Accept:n}),s=a.protocol==="http:"?Xr.default:ps;let l=s.get(a,u=>{e(u,l)}).on("error",r);l.end()}else e(o,i)}).on("error",r);i.end()};var fs=require("url"),ds=(t,e,r)=>new Promise(function(n,s){e||(e=f.rust.index);let i=wa(t,e),o=new fs.URL(i),c={hostname:o.hostname,port:o.port,path:o.pathname,protocol:o.protocol,headers:{},method:"GET"};r&&(c.headers.Authorization=r),W(c,(l,u)=>{if(B(l))return s(M(l));let p=Y(t,l,u,s),d;l.on("end",()=>{try{let b=Buffer.concat(p).toString().split(`
`).filter(I=>I).map(I=>JSON.parse(I));d={name:t,versions:b.filter(I=>I.yanked===!1).map(I=>I.vers),features:Object.keys(b.at(-1).features).filter(I=>I!=="default")}}catch(m){s(m)}n(d)})},s)});function wa(t,e){let r=t.replace(/"/g,"").toLowerCase(),n;r.length<=2?n=r.length.toFixed(0):r.length==3?n=`3/${r.substring(0,1)}`:n=`${r.substring(0,2)}/${r.substring(2,4)}`;let s=e.endsWith("/")?e:e+"/";return F(`${s}${n}/${r}`)}var gs=/^(?:\^|~)?v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i;function Sa(t,e){return t.indexOf(e)===-1?t.length:t.indexOf(e)}function Na(t,e){return t.lastIndexOf(e)===-1?t.length:t.lastIndexOf(e)}function ms(t){let e=t.replace(/^v/,"").replace(/\+.*$/,""),r=y===4?Na(e,"."):Sa(e,"-"),n=e.substring(0,r).split(".");return n.push(e.substring(r+1)),n}function Oa(t){if(!gs.test(t))throw new Error("Invalid argument not valid semver ('"+t+"' received)")}function Wt(t,e){y!==4&&[t,e].forEach(Oa);let r=ms(t),n=ms(e),s=Math.max(r.length-1,n.length-1);for(let l=0;l<s;l++){var i=parseInt(r[l]||"0",10),o=parseInt(n[l]||"0",10);if(i>o)return 1;if(o>i)return-1}if(r.length!==n.length)return r.length>n.length?1:-1;var c=r[r.length-1],a=n[n.length-1];if(c&&a){let l=c.split(".").map(d=>/^\d+$/.test(d)?parseInt(d,10):d),u=a.split(".").map(d=>/^\d+$/.test(d)?parseInt(d,10):d),p=Math.max(l.length,u.length);for(let d=0;d<p;d++){if(l[d]===void 0)return-1;if(u[d]===void 0)return 1;if(typeof l[d]=="string"&&typeof u[d]=="number")return parseInt(l[d].toString())>=parseInt(u[d].toString())?1:-1;if(typeof u[d]=="string"&&typeof l[d]=="number")return parseInt(u[d].toString())>=parseInt(l[d].toString())?-1:1;if(l[d]>u[d])return 1;if(u[d]>l[d])return-1}}else if(c||a)return c?-1:1;return 0}var hs=[">",">=","=","<","<="],_a={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]};function Ca(t){if(typeof t!="string")throw new TypeError("Invalid operator type, expected string but got "+typeof t);if(hs.indexOf(t)===-1)throw new TypeError("Invalid operator, expected one of "+hs.join("|"))}Wt.validate=function(t){return typeof t=="string"&&gs.test(t)};Wt.compare=function(t,e,r){Ca(r);var n=Wt(t,e);return _a[r].indexOf(n)>-1};var V=Wt;function j(t){return e=>(console.error(e),P.appendLine("Error fetching versions for "+t.item.key+": "+e),{item:t,error:t.item.key+": "+e})}var xs=S(require("https")),Ps=S(Kr());var Yr=new Ps.default({stdTTL:60*10});function Aa(t){let e={method:"POST",headers:{"Content-Type":"application/json"}};return new Promise((r,n)=>{let s=xs.request(f.vulnerability.osvBatch,e,i=>{let o="";i.on("data",c=>{o+=c}),i.on("end",()=>{try{let c=JSON.parse(o);for(let a=0;a<c.results?.length;a++)c.results[a].packageName=t.queries[a].package.name,c.results[a].version=t.queries[a].version,c.results[a].vulns&&(c.results[a].vulns=c.results[a].vulns.filter(l=>f.vulnerability.ghsa?!0:!l.id.startsWith("GHSA")));r(c)}catch(c){n(c)}})});s.on("error",i=>{n(i)}),s.write(JSON.stringify(t)),s.end()})}var Da=async t=>{try{let e=JSON.stringify({request:t,ghsaCheck:f.vulnerability.ghsa});if(Yr.has(e)){let r=Yr.get(e);if(r===void 0)throw new Error("Cached response is undefined");return r}else{let r=await Aa(t);return Yr.set(e,r),r}}catch(e){throw console.error("Error fetching data from OSV API:",e),P.appendLine("Error fetching data from OSV API: "+e),e}},Ts=async(t,e)=>{try{let r={queries:[]};for(let i=0;i<t.length;i++){let o=t[i].item.key,c=t[i].versions?.findIndex(a=>a===t[i]?.item?.value)??(t[i].versions?.length??0)-1;for(let a=0;a<=c;a++)!t[i].versions||!t[i]?.versions?.[a]||r.queries.push({version:t[i].versions?.[a],package:{name:o,ecosystem:e}})}w.setText("Info","Fetching vulnerabilities from OSV");let n=await Da(r),s=Va(n,t);return w.setText("Info","Vulnerabilities fetched from OSV"),s}catch(r){return console.error("Error querying multiple package vulnerabilities:",r),P.appendLine("Error querying multiple package vulnerabilities: "+r),[]}};function Va(t,e){let r=new Map;for(let n=0;n<t.results?.length;n++){let s=t.results[n].packageName;if(r.has(s)){let i=r.get(s);i?.versionVulnerabilities.push({version:t.results[n].version,vulnerabilities:t.results[n].vulns}),r.set(s,i)}else r.set(s,{packageName:s,versionVulnerabilities:[{version:t.results[n].version,vulnerabilities:t.results[n].vulns}]})}for(let n=0;n<e?.length;n++){let s=r.get(e[n].item.key),i=new Map;if(s?.versionVulnerabilities)for(let o=0;o<s?.versionVulnerabilities.length;o++){let c=s?.versionVulnerabilities[o],a=[];c?.vulnerabilities&&c?.vulnerabilities.forEach(l=>{a.push(l.id)}),i.set(c.version,a)}e[n].vulns=i}return e}var Pe=require("vscode");var Jr={settings:"Open settings",dashboard:"Go to Dashboard"};async function zr(t,e){return Pe.window.showErrorMessage(t,...Object.keys(e)).then(async r=>{await e[r??""]?.()})}function jt(){zr("Device Limit reached. You can edit your api key or visit dependi.io dashboard to manage devices.",{[Jr.settings]:()=>Pe.commands.executeCommand("workbench.action.openSettingsJson",{revealSetting:{key:ne+"apiKey",edit:!0}}),[Jr.dashboard]:()=>Pe.commands.executeCommand("vscode.open",`${f.api.proPanelURL}/api-key-management`)})}function Gt(){zr("Payment required. Please visit dependi.io dashboard to update your payment method.",{[Jr.dashboard]:()=>Pe.commands.executeCommand("vscode.open",`${f.api.proPanelURL}/payments`)})}function me(t,e){zr(e,{"Open settings":()=>Pe.commands.executeCommand("workbench.action.openSettingsJson",{revealSetting:{key:ne+t,edit:!0}})})}var Io=S(Kr());var vt=require("vscode"),yo=S(It());var se=S(It());function Eo(t="0.0.0",e,r){let n=En(t,!0),s=e.map(u=>En(u)),i=_u(e,s);n=Cu(n);let o=s[0];if(r){let u=ku(r,n,s);if(u)return u}if(Vu()&&o){let u=(0,se.minVersion)(n)?.toString()??"0.0.0";if((0,se.gt)(u,o))return[!0,!1,t]}let c=!1;switch(y){case 1:c=f.rust.informPatchUpdates;break;case 3:c=f.npm.informPatchUpdates;break;case 5:c=f.php.informPatchUpdates;break;case 2:c=f.go.informPatchUpdates;break;case 4:c=f.python.informPatchUpdates;break;case 6:c=f.dart.informPatchUpdates;break;case 7:c=f.csharp.informPatchUpdates;break}let a=c?(0,se.compare)(o,(0,se.minVersion)(n)??"0.0.0")===1:!1,l=(0,se.maxSatisfying)(s,n);return l&&y===4?[(0,se.satisfies)(o,n),a,i[l]]:[(0,se.satisfies)(o,n),a,l]}function _u(t,e){return y!==4?{}:t.reduce((r,n,s)=>(r[e[s]]=n,r),{})}function Cu(t){let e=t.charCodeAt(0);return e>47&&e<58?`^${t}`:t}function ku(t,e,r){let n=En(t);return(0,se.satisfies)(n,e,{includePrerelease:!0})?[n===r[0],!1,t]:[!1,!1,t]}function En(t,e){return y===4?yn(t):Au(t,e)}function Au(t,e){let r="",n="",s=t,i=t.match(/^(\^|~|>=?|<=?|=)?(v|V)?/);if(i&&i[0])r=i[1]||"",n=i[2]||"",s=t.slice(i[0].length).trim();else if(e){let a=t.charCodeAt(0);if(a<47||a>58)return t}let o=0;for(let a=0;a<s.length;a++)if(s[a]==="."&&(o++,o>1))return r+n+s;let c=s;return s.includes(".")?s.split(".").length===2&&(c=`${s}.0`):c=`${s}.0.0`,r+n+c}function Du(t){return t.replace(/\.dev(\d+)/,"-dev.$1").replace(/\.post(\d+)/,"-post.$1").replace(/\.a(\d+)/,"-alpha.$1").replace(/\.b(\d+)/,"-beta.$1").replace(/\.rc(\d+)/,"-rc.$1").replace(/a(\d+)/,"-alpha.$1").replace(/b(\d+)/,"-beta.$1").replace(/rc(\d+)/,"-rc.$1").replace(/c(\d+)/,"-c.$1")}function yn(t){let e="",r="",n=t,s=t.match(/^(=|~|>=?|<=?)?(v|V)?/);s&&s[0]&&(e=s[1]||"",r=s[2]||"",n=t.slice(s[0].length).trim());let i=Du(n),o=/^(\d+)\.(\d+)(?:\.(\d+))?([-a-zA-Z0-9.]+)?$/,c=i.match(o);if(c){let a=c[1],l=c[2],u=c[3]||0,p=c[4]?`-${c[4].slice(1)}`:"",d=`${a}.${l}.${u}${p}`;return e+r+d}else return e+r+i}function Vu(){switch(y){case 1:return f.rust.silenceVersionOverflows;case 3:return f.npm.silenceVersionOverflows;case 5:return f.php.silenceVersionOverflows;case 2:return f.go.silenceVersionOverflows;case 4:return f.python.silenceVersionOverflows;case 6:return f.dart.silenceVersionOverflows;case 7:return f.csharp.silenceVersionOverflows}return!1}function bn(t,e,r,n,s,i,o){let c=e.value?.replace(",",""),[a,l,u]=Eo(c,r,e.lockedAt),p=v=>{let re=v.split(`
`),T=new vt.MarkdownString("#### Errors ");return T.appendMarkdown(`
`),re.filter(ge=>ge).forEach(ge=>{T.appendMarkdown("* "),T.appendText(ge.trim()),T.appendMarkdown(`
`)}),T},d=new vt.MarkdownString,m=n.position,b={[m]:{contentText:""}},I="COMP";if(o)d=p(o),I="ERROR";else{if(Mu(d,i,c),d.appendMarkdown("#### Versions"),d.appendMarkdown(Uu(s,e.key,e)),d.isTrusted=!0,Bu(d,r,e,u??"",i,n,s),c=="?"){let v=r[0];t.edit(re=>{re.replace(e.range,v.slice(1,v.length-2))}),t.document.save()}(0,yo.validRange)(y===4?yn(c):c)?r[0]!==u&&(I=a?"COMP":"INCOMP"):I="ERROR",l&&I==="COMP"&&(I="PATCH")}let K=Fu(n,I);b[m].contentText=K.replace("${version}",r[0]);let D=i?.get(e.lockedAt??c);if(D&&D.length>0){let v=n.vulnText.replace("${count}",`${D?.length}`);b[m].contentText=b[m].contentText+"	"+v}return $u(c)&&(b[m].contentText=""),[{range:m=="after"?e.decoRange:new vt.Range(e.line,0,e.line,e.endOfLine),hoverMessage:d,renderOptions:b},I]}function $u(t){return t?t.startsWith("file:")||t.startsWith("path:")||t.startsWith("link:")||t.startsWith("git:")||t.startsWith("git+")||t.startsWith("github:")||t.startsWith("workspace:")||t.startsWith("ssh:")||t.startsWith("http:")||t.startsWith("https:"):!1}function Fu(t,e){let r=t.compatibleText;switch(e){case"PATCH":r=t.patchUpdateText;break;case"INCOMP":r=t.incompatibleText;break;case"ERROR":r=t.errorText;break}return r}function Uu(t,e,r){let n=e.replace(/"/g,"");switch(t){case 1:return` _([View crate](https://crates.io/crates/${n}) | [Check reviews](https://web.crev.dev/rust-reviews/crate/${n}))_`;case 2:return` _([View module](https://pkg.go.dev/${n}) | [Check docs](https://pkg.go.dev/${n}#section-documentation))_`;case 3:return r?.source==="jsr"?` _([View package](https://jsr.io/${n}))_`:` _([View package](https://npmjs.com/package/${n}))_`;case 5:return` _([View package](https://packagist.org/packages/${n}))_`;case 4:return` _([View package](https://pypi.org/project/${n}))_`;case 6:return` _([View package](https://pub.dev/packages/${n}))_`;case 7:return` _([View package](https://www.nuget.org/packages/${n}))_`;default:return""}}function qu(t,e,r,n){switch(t){case 1:return`[(docs)](https://docs.rs/crate/${e}/${r})`;case 2:return`[(docs)](https://pkg.go.dev/${e}@${r}#section-documentation)`;case 3:return n?.source==="jsr"?`[(docs)](https://jsr.io/${e}/${r})`:`[(docs)](https://npmjs.com/package/${e}/v/${r})`;case 5:return`[(docs)](https://packagist.org/packages/${e}#${r})`;case 4:return`[(docs)](https://pypi.org/project/${e}/${r})`;case 6:return`[(docs)](https://pub.dev/packages/${e}/versions/${r})`;case 7:return`[(docs)](https://www.nuget.org/packages/${e}/${r})`;default:return""}}function Mu(t,e,r){let n=e?.get(r);if(n?.length){t.appendMarkdown("#### Vulnerabilities (Current)");let s=[];n?.forEach(i=>{let o=` - [${i}](https://osv.dev/vulnerability/${i}) 
`;s.push(o)}),t.appendMarkdown(`
`+s.join(""))}}function Bu(t,e,r,n,s,i,o){for(let c=0;c<e.length;c++){let a=e[c],l=s?.get(a),u={key:r.key,version:a,startLine:r.range.start.line},p=a===n,d=encodeURI(JSON.stringify(u)),m=c===0||p?" "+qu(o,r.key,a,r):"",b=l?.length?i.vulnText.replace("${count}",`${l?.length}`):"",I=`${p?"**":""}[${a}](command:${L.REPLACE_VERSIONS}?${d})${m}${p?"**":""}  ${b}`;t.appendMarkdown(`
 * `),t.appendMarkdown(I)}}var bo=require("vscode");var ye;function In(){return ye||(ye=Wu()),ye}function Ro(){ye&&(ye.compatibleType.dispose(),ye.patchUpdateType.dispose(),ye.incompatibleType.dispose(),ye.errorType.dispose(),ye=void 0),In()}function Wu(){let t=f.decorator.compatible.template,e={...f.decorator.compatible.css},r=f.decorator.patchUpdate.template,n={...f.decorator.patchUpdate.css},s=f.decorator.incompatible.template,i={...f.decorator.incompatible.css},o=f.decorator.error.template,c={...f.decorator.error.css},a=f.decorator.vulnerability.template,l=f.decorator.position;return Rn(e,l,t),Rn(i,l,s),Rn(c,l,o),{compatibleType:nr(e),patchUpdateType:nr(n),incompatibleType:nr(i),errorType:nr(c),compatibleText:t,patchUpdateText:r,incompatibleText:s,errorText:o,vulnText:a,position:l}}function Rn(t,e,r){(t[e]==null||t[e]==null)&&(t[e]={margin:"0.5em"}),t[e].contentText=r}function nr(t){return bo.window.createTextEditorDecorationType(t)}function le(t,e,r){console.debug("Decorating",t.document.fileName);let n=In(),s=[],i=e.filter(l=>l.item.registry&&l.item.registry!=="crates-io"&&(!l.versions||l.versions.length===0)?!1:(l&&!l.error&&l.versions&&l.versions.length||(l.error||(l.error=l.item.key+": No versions found"),s.push(`${l.error}`)),l)),o=[],c=[],a=[];for(let l=i.length-1;l>-1;l--){let u=i[l];try{let p=bn(t,u.item,u.versions||[],n,r,u.vulns,u.error);if(p)switch(p[1]){case"COMP":o.push(p[0]);break;case"PATCH":o.push(p[0]);break;case"INCOMP":c.push(p[0]);break;case"ERROR":a.push(p[0]);break}}catch(p){console.error(p),P.appendLine(`Failed to build decorator (${u.item.value})`),s.push(`Failed to build decorator (${u.item.value})`)}}t.setDecorations(n.compatibleType,o),t.setDecorations(n.incompatibleType,c),t.setDecorations(n.errorType,a),s.length?w.setText("Error",`Completed with errors ${s.join(`
`)}`,!0):w.setText("Info")}var xt=class{constructor(e){this.item=e}};var C=new Map,ee=class{constructor(e,r){this.fetcher=e,this.parser=r}parse(e){let n=this.parser.parse(e.document).map(i=>new xt(i)),s=C.get(y);return s||(s=new Io.default({stdTTL:5*60,checkperiod:5*30,useClones:!1}),C.set(y,s)),n=n.map(i=>{let o=s.get(i.item.key+i.item.range.start.line);return o?(i.item.value==="latest"&&(i.item.value=o.item.latestVersion),i.item.latestVersion=o.item.latestVersion,o.item=i.item):s.set(i.item.key+i.item.range.start.line,i),o||i}),n.forEach(i=>{i.versions&&this.modifyDependecy(i)}),n}async parseAndDecorate(e){try{let r=this.parse(e),n=[this.fetcher.versions(r)];f.vulnerability.enabled&&n.push(this.fetcher.vulns(r)),await Promise.all(n),O.updateAllData=r.map(s=>({key:s.item.key,version:this.buildVersionWithPrefix(s),startLine:s.item.range.start.line})),le(e,r,y),f.vulnerability.enabled&&this.fetcher.vulns(r).then(()=>{le(e,r,y)})}catch(r){console.error(r)}}modifyDependecy(e){}buildVersionWithPrefix(e){let r=e.versions?.[0]??"",n=e.item.value||"";if(n==="*")return"*";let s=n.match(/^(\^|~|>=|<=|>|<|=)?(.+)$/),i=s?s[1]:"",o=i;return o?o=i+r:o=r,o}};var $=class{constructor(e,r){this.vulnsEnvironment="";if(!e){me(r,"Please set the URL for the fetcher");return}}async vulns(e){w.setText("Loading","\u{1F440} Fetching vulnerabilities");let r=e.filter(c=>!c.vulns||c.vulns?.size===0),s=Hu(r,500).map(async c=>Ts(c,Gr)),o=(await Promise.all(s)).reduce((c,a)=>c.concat(a),[]);return o.forEach(c=>{let a=C.get(y)?.get(c.item.key+c.item.range.start.line);a?(console.log("cached vulns",c.item.key,c.vulns),a.vulns=c.vulns):(console.log("new vulns",c.item.key),C.get(y)?.set(c.item.key+c.item.range.start.line,c))}),o}async versions(e){let r=e.some(i=>i.versions&&i.versions.length>=0),n=this.fetch(r),s=e.map(i=>{let o=C.get(y)?.get(i.item.key+i.item.range.start.line);return!o||!o.versions?o&&o.error?(console.log("cached",i.item.key),Promise.resolve(o)):(console.log("fetching",i.item.key,o?.error),n(i)):(console.log("cached",i.item.key),Promise.resolve(o))});return Promise.all(s)}checkUnstables(e,r,n){return e===1||e===2&&vo(n)?!1:vo(r)}};function Hu(t,e){let r=[],n=[],s=0;return t.forEach(i=>{let o=i.versions?.length??0;s+o<=e?(n.push(i),s+=o):(r.push(n),i.versions&&i.versions.length>e&&(i.versions=i.versions.slice(0,1e3)),n=[i],s=o)}),n.length>0&&r.push(n),r}function vo(t){return t=t.toLowerCase(),t.indexOf("-alpha")!==-1||t.indexOf("-beta")!==-1||t.indexOf("-rc")!==-1||t.indexOf("-snapshot")!==-1||t.indexOf("-dev")!==-1||t.indexOf("-preview")!==-1||t.indexOf("-experimental")!==-1||t.indexOf("-canary")!==-1||t.indexOf("-pre")!==-1||t.indexOf("-next")!==-1||t.indexOf("-nightly")!==-1||t.indexOf("-nullsafety")!==-1||t.indexOf("-nnbd")!==-1||t.indexOf("+")!==-1}var Le=class extends ${fetch(){return this.fetchWithRegistries([])}fetchWithRegistries(e){let r=this;return function(n){let s=e.find(c=>n.item.registry==c.name),i=n.item.registry!==void 0?s?.index:f.rust.index,o=n.item.registry!==void 0?s?.token:void 0;return n.item.registry&&n.item.registry!=="crates-io"&&!s?.index||n.versions&&n.versions.length>0?Promise.resolve(n):ds(n.item.key,i,o).then(c=>{let a=c.versions.filter(l=>l!==""&&l!==void 0&&!r.checkUnstables(f.rust.unstableFilter,l,n.item.value)).sort(V).reverse();return n.versions=a,n}).catch(j(n))}}async versions(e){return super.versions(e)}async fetchVersionsWithRegistries(e,r){let n=this.fetchWithRegistries(r),s=e.map(i=>{let o=C.get(y)?.get(i.item.key+i.item.range.start.line);return!o||!o.versions?o&&o.error?Promise.resolve(o):n(i):Promise.resolve(o)});return Promise.all(s)}};var xo=require("vscode");var sr=(a=>(a.NULL="Null",a.UNDEFINED="Undefined",a.DLR="Device Limit reached. You can edit your api key or visit dependi.io dashboard to manage devices.",a.IVDID="Invalid device ID",a.PAYRQ="Payment required. Please visit dependi.io dashboard to update your payment method.",a.UNAUTH="Unauthorized, please check your api key.",a.IVAK="Invalid api key or api key not found. Please check your api key.",a.UINA="User is not active. Please check emails from us or visit dependi.io dashboard.",a))(sr||{});function We(t){if(!t)return"Null";let e=t.split(" - ")[0];return sr[e]||t}async function ju(t,e){let r={Language:t.Language,Packages:t.Packages,IgnoreUnstables:t.IgnoreUnstables,VulnerabilityCheck:t.VulnerabilityCheck,GhsaCheck:t.GhsaCheck};return await Re("v1/indexes",{method:"POST",body:JSON.stringify(r),...e}).then(n=>{if(n.status!==200)switch(We(n.error)){case"Device Limit reached. You can edit your api key or visit dependi.io dashboard to manage devices.":return jt(),[];case"Payment required. Please visit dependi.io dashboard to update your payment method.":return Gt(),[];case"Unauthorized, please check your api key.":return me("apiKey","Unauthorized, please check your api key."),[];case"Invalid api key or api key not found. Please check your api key.":return me("apiKey","Invalid api key or api key not found. Please check your api key."),[];case"User is not active. Please check emails from us or visit dependi.io dashboard.":me("apiKey","User is not active. Please check emails from us or visit dependi.io dashboard.");default:return xo.window.showErrorMessage(We(n.error)),[]}let s=n.body?.filter(c=>c?.Name),i=new Map(s?.map(c=>[c.Name,c]));return t.Dependencies.map(c=>{let a=i.get(c.item.key);if(c.error=a?.Error,a&&a.Versions&&(c.versions=a.Versions,c.item.latestVersion=a.LatestVersion,c.item.value==="latest"&&(c.item.value=c.item.latestVersion),a.Vulns)){let l=Object.entries(a.Vulns);c.vulns=new Map(l)}return c})}).catch(n=>(console.error("Catch get versions",n),P.appendLine("Catch get versions: "+n),[]))}var Po={getVersions:ju};var Pt=require("vscode"),_=class{constructor(e){this.key="";this.value="";this.source="";this.start=-1;this.end=-1;this.line=-1;this.endOfLine=-1;this.range=new Pt.Range(0,0,0,0);this.decoRange=new Pt.Range(0,0,0,0);e&&(this.key=e.key,this.value=e.value,this.registry=e.registry,this.start=e.start,this.end=e.end,this.line=e.line,this.decoRange=e.decoRange)}copyFrom(e,r,n,s,i,o,c,a){e&&(this.key=e),r&&(this.value=r),n&&(this.start=n),s&&(this.end=s),i&&(this.line=i),o&&(this.endOfLine=o),c&&(this.lockedAt=c),a&&(this.registry=a)}createRange(){this.range=new Pt.Range(this.line,this.start,this.line,this.end)}createDecoRange(){this.decoRange=new Pt.Range(this.line,this.start,this.line,this.endOfLine)}isValid(){return this.key.length>0&&this.value?.length&&this.start>-1&&this.end>-1&&(/\d/.test(this.value)||this.value==="*")}};function Gu(t){switch(t[0]){case"<":return t.startsWith("<<<<<<<");case"=":return t.startsWith("=======");case">":return t.startsWith(">>>>>>>");default:return!1}}function k(t){return t==='"'||t==="'"}function Xu(t){return t.includes("dependi:")&&t.includes("disable-check")}function ue(t,e,r){if(t.isEmptyOrWhitespace)return!0;let n=t.firstNonWhitespaceCharacterIndex,s=t.text[n];return!!(r&&r.includes(s)||Xu(t.text)||Gu(t.text)||Ku(t.text,e))}function Ku(t,e){if(!e||e.trim()==="")return!1;t=t.trim();let r=e.split(",").map(n=>n.trim());for(let n of r)if(n.startsWith("*")&&n.endsWith("*")){let s=n.slice(1,-1);if(t.includes(s))return!0}else if(n.startsWith("*")){let s=n.slice(1);if(t.endsWith(s))return!0}else if(n.endsWith("*")){let s=n.slice(0,-1);if(t.startsWith(s))return!0}return!1}var vn=class{constructor(){this.items=[],this.bypass=!1}},He=class{parse(e){let r=new vn;for(let n=0;n<e.lineCount;n++){let s=e.lineAt(n);if(ue(s,f.python.ignoreLinePattern,["#","-","."])||r.bypass||!s.text.includes("="))continue;let i=Ju(s);i.line=s.lineNumber,i.createRange(),i.createDecoRange(),r.items.push(i)}return r.items}};function Yu(t){let e=[">","<","~","!","="];for(let r=0;r<t.text.length;r++)if(e.includes(t.text[r]))return r;return-1}function Ju(t){let e=Yu(t),r=e,n=t.text.length,s=t.text.substring(t.firstNonWhitespaceCharacterIndex,e),i=t.text.substring(r,n);i.startsWith("==")||i.startsWith(">=")||i.startsWith("<=")||i.startsWith("~=")?r+=2:(i.startsWith(">")||i.startsWith("<")||i.startsWith("!"))&&(r+=1),i=i.trim().replace(/^(==|>=|<=|~=|>|<|!)\s+/,"$1"),k(s[0])&&k(s[s.length-1])&&(s=s.substring(1,s.length-1)),k(i[0])&&k(i[i.length-1])&&(i=i.substring(1,i.length-1),r++,n--),s.includes("[")&&(s=s.split("[")[0]);let o=new _;return o.copyFrom(s.trim(),i,r,n,t.lineNumber,t.range.end.character),o}function zu(t,e){return e=e.trim(),e.startsWith("==")?t===e.slice(2).trim():e.startsWith("!")?t!==e.slice(1).trim():e.startsWith(">=")?we(t,e.slice(2).trim())>=0:e.startsWith("<=")?we(t,e.slice(2).trim())<=0:e.startsWith(">")?we(t,e.slice(1).trim())>0:e.startsWith("<")?we(t,e.slice(1).trim())<0:!1}function we(t,e){let[r,n]=t.split(/[^\d.]/,2),[s,i]=e.split(/[^\d.]/,2),o=r.split(".").map(Number),c=s.split(".").map(Number);for(let a=0;a<Math.max(o.length,c.length);a++){let l=o[a]||0,u=c[a]||0;if(l<u)return-1;if(l>u)return 1}return n&&i?n.localeCompare(i):n?1:i?-1:0}function Se(t){let e;return t.includes(";")?e=t.split(";")[0].split(",").map(r=>r.trim()):e=t.split(",").map(r=>r.trim()),e}function Ne(t,e){let r=t.find(n=>n.trim().startsWith("=="));if(r){if(t.some(n=>n.includes("*"))){let n=t.find(i=>i.trim().startsWith("=="))?.slice(2).trim().split(".")[0],s=e.filter(i=>i.startsWith(n||""));return s.length>0?s.reduce((i,o)=>we(i,o)>=0?i:o):null}return r.slice(2).trim()}else if(t.some(n=>n.includes("*"))){let n=t.find(i=>i.trim().startsWith("=="))?.slice(2).trim().split(".")[0];n===void 0&&(n=t.find(i=>i.includes("*"))?.split(".")[0]?.replace(/[^0-9*]/g,""));let s=e.filter(i=>i.startsWith(n||""));return s.length>0?s.reduce((i,o)=>we(i,o)>=0?i:o):null}else{let n=e.filter(s=>t.every(i=>zu(s,i)));return n.length>0?n.reduce((s,i)=>we(s,i)>=0?s:i):null}}var Tt=class extends ${async versions(e){let r=0;switch(y){case 4:r=f.python.unstableFilter;break;case 3:r=f.npm.unstableFilter;break;case 2:r=f.go.unstableFilter;break;case 5:r=f.php.unstableFilter;break;case 1:r=f.rust.unstableFilter;break;case 6:r=f.dart.unstableFilter;break;case 7:r=f.csharp.unstableFilter;break}let n={Language:y,Packages:e.map(i=>i.item),Dependencies:e,IgnoreUnstables:r,VulnerabilityCheck:f.vulnerability.enabled,GhsaCheck:f.vulnerability.ghsa};f.api.deviceID===""&&(console.error("DeviceID is empty"),P.appendLine("DeviceID is empty"));let s=await Po.getVersions(n,{headers:{Authorization:f.api.key,"X-Device-ID":f.api.deviceID,"Content-Type":"application/json"}});return y===4&&(s=s.map(o=>this.mapVersions(o))),Promise.all(s)}async vulns(e){throw new Error("Method not implemented.")}mapVersions(e,r){if(!e.versions)return e;let n=e.versions.filter(o=>o!==""&&o!==void 0).sort(V).reverse();if(r){let o=Se(r.value??""),c=Ne(o,n);return r.value=c||r.value,{item:r,versions:n}}let s=Se(e.item.value??""),i=Ne(s,n);return e.item.value=i||e.item.value,e.versions=n,e}fetch(e){throw new Error("Method not implemented.")}};var To=t=>new Promise(function(e,r){let n=Zu(t),s=q(n);W(s,(o,c)=>{if(B(o))return r(M(o));let a=Y(t,o,c,r),l;o.on("end",()=>{try{let p=Buffer.concat(a).toString().split(`
`);if(p.length===1&&p[0]==="")return Qu(t).then(e).catch(r);l={name:t,versions:p}}catch(u){r(u)}e(l)})},r)}),Qu=t=>new Promise(function(e,r){let n=ep(t),s=q(n);W(s,(o,c)=>{if(B(o))return r(M(o));let a=Y(t,o,c,r),l;o.on("end",()=>{try{let u=a.toString(),p=JSON.parse(u);if(p.Version===void 0)return r(new Error(`Invalid response from goproxy: ${u} for ${n}`));l={name:t,versions:[p.Version]}}catch(u){r(u)}e(l)})},r)});function Zu(t){let e=t.toLowerCase(),r=`${f.go.index}/${e}/@v/list`;return F(r)}function ep(t){let e=t.toLowerCase(),r=`${f.go.index}/${e}/@latest`;return F(r)}var ir=class extends ${fetch(){let e=this;return async function(r){return To(r.item.key).then(n=>{let s=n.versions.filter(i=>i!==""&&i!==void 0&&!e.checkUnstables(f.go.unstableFilter,i,r.item.value)).sort(V).reverse();return r.versions=s,r}).catch(j(r))}}};var xn=(t,e)=>new Promise(function(r,n){let s=np(e,t),i=q(s);e||(i.headers={Accept:"application/vnd.npm.install-v1+json"}),W(i,(c,a)=>{if(B(c))return n(M(c));var l;let u=Y(t,c,a,n);c.on("end",()=>{try{let p=JSON.parse(Buffer.concat(u).toString()),d=[],m="";({versions:d,err:m}=e?rp(p,e):tp(p,d)),l={name:t,versions:d,latestVersion:e?p.latest:p["dist-tags"].latest,error:m}}catch(p){console.error("Error parsing response:",p),P.appendLine("Error parsing response: "+p),n(p)}r(l)})},n,e?void 0:"application/vnd.npm.install-v1+json")}),tp=(t,e)=>{let r="";if(t.versions){let n=Object.entries(t.versions);n.length&&n.forEach(([s,i])=>{!i.deprecated&&(f.npm.unstableFilter!==0||!s.includes("-"))?e.push(s):i.deprecated&&(r=i.deprecated)})}return e.length>0&&(r=""),{versions:e,err:r}},rp=(t,e)=>{let r=[];return e===t.latest?r=[e]:r=[e,t.latest],{versions:r,err:""}};function np(t,e){return F(`${f.npm.index}/${t?`-/package/${e}/dist-tags`:`${e}`}`)}var Lt=class extends ${fetch(e){let r=this;return async function(n){return(e?xn(n.item.key,n.item.value):xn(n.item.key)).then(i=>{let o=i.versions.filter(c=>c!==""&&c!==void 0&&!r.checkUnstables(f.npm.unstableFilter,c,n.item.value)).sort(V).reverse();return n.versions=o,n.item.latestVersion=i.latestVersion,n.item.value=n.item.value==="latest"?i.latestVersion:n.item.value,n.error=i.error,n}).catch(j(n))}}};var Pn=t=>new Promise(function(e,r){let n=sp(t),s=q(n);W(s,(o,c)=>{if(B(o))return r(M(o));var a;let l=Y(t,o,c,r);o.on("end",()=>{let u=JSON.parse(Buffer.concat(l).toString());try{a={name:t,versions:u.packages[t].map(p=>p.version.replace(/^v/,""))}}catch(p){r(p)}e(a)})},r)});function sp(t){return F(`${f.php.index}/p2/${t}.json`)}var or=class extends ${fetch(e){let r=this;return async function(n){return(e?Pn(n.item.key):Pn(n.item.key)).then(i=>{let o=i.versions.filter(c=>c!==""&&c!==void 0&&!r.checkUnstables(f.php.unstableFilter,c,n.item.value)).sort(V).reverse();return n.versions=o,n}).catch(j(n))}}};var Lo=t=>new Promise(function(e,r){let n=ip(t),s=q(n);W(s,(o,c)=>{if(B(o))return r(M(o));let a=Y(t,o,c,r),l;o.on("end",()=>{try{let u=JSON.parse(Buffer.concat(a).toString()),p=Object.keys(u.releases).filter(d=>u.releases[d].every(b=>!b.yanked));l={name:t,versions:p}}catch(u){r(u)}e(l)})},r)});function ip(t){return F(`${f.python.index}/${t}/json`)}var ar=class extends ${fetch(){let e=this;return async function(r){return Lo(r.item.key).then(n=>e.mapVersions(n,r)).catch(j(r))}}checkUnstables(e,r,n){return e===1||e===2&&wo(n)?!1:wo(r)}mapVersions(e,r){let n=e.versions.filter(o=>o!==""&&o!==void 0&&!this.checkUnstables(f.python.unstableFilter,o,r.item.value)).sort(V).reverse(),s=Se(r.item.value??""),i=Ne(s,n);return r.item.value=i||r.item.value,r.versions=n,r}};function wo(t){let e=/\..*a|b.*/;return t.indexOf(".alpha")!==-1||t.indexOf(".beta")!==-1||t.indexOf(".rc")!==-1||t.indexOf(".SNAPSHOT")!==-1||t.indexOf(".dev")!==-1||t.indexOf(".preview")!==-1||t.indexOf(".experimental")!==-1||t.indexOf(".canary")!==-1||t.indexOf(".pre")!==-1||t.indexOf("rc")!==-1||e.test(t)}var St=require("vscode");var wn=S(require("path")),Sn=S(require("fs"));var So=S(It()),Tn=class{constructor(){this.lockedValue="",this.dependency=""}},cr=class{constructor(){}parse(e,r){let n=e.split(`
`),s=new Tn;for(let i=0;i<n.length;i++){let o=n[i];this.isTableSection(o)&&(o=n[++i],o.startsWith("name")&&(s.dependency=this.getPackageName(o),Oe(r,s.dependency)&&(o=n[++i],o.startsWith("version")&&(s.lockedValue=this.getParsedVersion(o),Ln(s,r),i++))))}return r}isTableSection(e){return e.startsWith("[[")&&e.endsWith("]]")}getPackageName(e){let r=e.split(" = ")[1];return wt(r)}getParsedVersion(e){let r=e.split("version = ")[1];return wt(r)}};function Oe(t,e){return t.some(r=>r.key===e)}function wt(t){return t.replace(/[^a-zA-Z0-9-_.*+]/g,"").trim()}function Ln(t,e){let r=e.find(n=>n.key===t.dependency);r&&(!r.lockedAt||r.value&&(0,So.satisfies)(t.lockedValue,r.value))&&(r.lockedAt=t.lockedValue),t.lockedValue="",t.dependency=""}var Nn=class{constructor(){this.inInlineTable=!1,this.inArray=!1,this.isMultipleDepTable=!1,this.isSingle=!1,this.items=[],this.currentItem=new _,this.bypass=!1,this.isSubTable=!1}},je=class{constructor(e,r){this.pattern=e;this.enableLockFileParsing=r}parse(e){let r=[],n=new Nn;for(let s=0;s<e.lineCount;s++){let i=e.lineAt(s);if(!ue(i,this.pattern,["#"])){if(fp(i)){if(n.bypass=!1,n.isSingle&&this.addItem(n,r),op(i.text))n.isMultipleDepTable=!0,n.isSingle=!1,n.isSubTable=!1;else if(pp(i.text)){n.isMultipleDepTable=!1,n.isSubTable=!1,n.isSingle=!0,n.currentItem=new _;let o=i.text;o.includes("#")&&(o=o.substring(0,o.indexOf("#")).trim()),n.currentItem.key=o.substring(o.lastIndexOf(".")+1,o.indexOf("]"))}else n.isMultipleDepTable=!1,n.isSingle=!1,n.isSubTable=!1,n.bypass=!0;continue}else if(this.isSubTable(i.text,n)){n.bypass=!1,n.isSubTable=!0;continue}if(!n.bypass)if(n.isMultipleDepTable||n.isSubTable){let o=this.parsePair(i.text,s);if(!o)continue;n.currentItem.copyFrom(o.key,o.value,o.start,o.end,s,i.range.end.character,void 0,o.registry),this.addItem(n,r);continue}else{let o=this.parsePair(i.text,s);if(!o)continue;switch(o.key){case"version":n.currentItem.copyFrom(void 0,o.value,o.start,o.end,s,i.range.end.character);continue;case"registry":n.currentItem.registry=o.value;continue;case"package":n.currentItem.copyFrom(o.value);continue;case"features":case"default-features":case"path":case"workspace":continue;default:}}}}return this.addItem(n,r),this.enableLockFileParsing?dp(r):r}addItem(e,r){e.currentItem.isValid()&&(e.currentItem.createRange(),e.currentItem.createDecoRange(),r.push(e.currentItem),e.currentItem=new _)}parsePair(e,r){let n=new _,s=e.indexOf("=");if(s===-1)return;r=s+1;let i=e.indexOf("#");if(n.key=ur(e.substring(0,s)),n.key=n.key.replace(".version",""),n.value=e.substring(s+1,i>-1?i:e.length).trim().replace(/^"|"$|'/g,""),!(lr(n.value)||mp(n.value)||hp(n.key)))return e.indexOf("{")>-1?(_n(e,n),On(e,n),lp(e,n),n.start>-1?n:void 0):(n.start=e.indexOf(n.value,s),n.end=n.start+n.value.length,n.start>-1?n:void 0)}isSubTable(e,r){return!1}};function On(t,e){let r=e.start,n=t.indexOf("version");if(n!==-1)for(r=n+7;r<t.length;){if(t[r]==="="){e.start=r,ap(t,e);return}r++}}function op(t){return t.includes("dependencies]")}function ap(t,e){let r=e.start,n=-1,s=0;for(;r++<t.length;){let o=t[r];if(k(o)){if(s++,s===2){r++;break}continue}if(Cn(o)){if(n>-1)break;continue}else if(n>-1)continue;n=r}r--;let i=t.substring(n,r);lr(i)||(e.value=i,e.start=n,e.end=e.start+e.value.length)}function _n(t,e){let r=e.start,n=t.indexOf("package");if(n!=-1)for(r=n+7;r<t.length;){if(t[r]==="="){cp(t,e,r);return}r++}}function cp(t,e,r){let n=r,s=-1;for(;n++<t.length;){let i=t[n];if(Cn(i)||k(i)){if(s>-1)break;continue}else if(s>-1)continue;s=n}e.key=t.substring(s,n)}function lp(t,e){let r=e.start,n=t.indexOf("registry");if(n!=-1)for(r=n+8;r<t.length;){if(t[r]==="="){up(t,e,r);return}r++}}function up(t,e,r){let n=r,s=-1;for(;n++<t.length;){let i=t[n];if(Cn(i)||k(i)){if(s>-1)break;continue}else if(s>-1)continue;s=n}e.registry=t.substring(s,n)}function Cn(t){return t===" "||t==="	"}function pp(t){return t.includes("dependencies.")}function lr(t){return t==="true"||t==="false"}function ur(t){return t.replace(/[^a-zA-Z0-9-_.*]/g,"").trim()}function fp(t){let e=t.firstNonWhitespaceCharacterIndex;return t.text[e]==="["}function dp(t){let e=St.window.activeTextEditor?.document.uri.fsPath,r=wn.default.dirname(e||"");try{let s=Sn.default.readdirSync(r).find(i=>i.endsWith(".lock"));if(s){let i=wn.default.join(r,s),o=Sn.default.readFileSync(i,"utf8");t=new cr().parse(o,t),St.commands.executeCommand("setContext","dependi.hasLockFile",!0)}else St.commands.executeCommand("setContext","dependi.hasLockFile",!1)}catch(n){console.error(n)}return t}function mp(t){return["git","path"].some(r=>t.includes(r))}function hp(t){return["."].some(r=>t.includes(r))}var Nt=class{constructor(e,r,n){this.name="";this.name=e,this.index=r,this.token=n}};var Ge=class extends je{constructor(){super(f.rust.ignoreLinePattern,f.rust.lockFileEnabled)}};function kn(t){let e=[],r=t.split(`
`),n=null,s=null,i=null;for(let o=0;o<r.length;o++){let c=r[o].trim();if(c.startsWith("#")||c==="")continue;let a=c.match(/^\[registries\.(.+?)\]$/);if(a){n&&e.push(new Nt(n,s||void 0,i||void 0)),n=a[1],s=null,i=null;continue}if(n){let l=c.match(/^index\s*=\s*"(.*?)"/);l&&(s=l[1].replace("sparse+",""));let u=c.match(/^token\s*=\s*"(.*?)"/);u&&(i=u[1])}}return n&&e.push(new Nt(n,s||void 0,i||void 0)),e}var An=class{constructor(){this.inRequire=!1,this.items=[],this.bypass=!1}},Xe=class{parse(e){let r=new An;for(let n=0;n<e.lineCount;n++){let s=e.lineAt(n);if(ue(s,f.go.ignoreLinePattern,["/"])||r.bypass)continue;let i=gp(s);if(i==="block"){r.inRequire=!0;continue}if(r.inRequire){if(Ep(s)){r.inRequire=!1;continue}let o=No(s);o.createRange(),o.createDecoRange(),r.items.push(o)}if(i==="single"&&!r.inRequire){let o=No(s);o.createRange(),o.createDecoRange(),r.items.push(o)}}return r.items}};function gp(t){let e=t.firstNonWhitespaceCharacterIndex,r=t.text.substring(e);return r.startsWith("require (")?"block":r.startsWith("require")?"single":null}function Ep(t){return t.text[t.firstNonWhitespaceCharacterIndex]===")"}function No(t){let e=t.text.indexOf(" ",t.firstNonWhitespaceCharacterIndex),r=e+1,n=t.text.indexOf(" ",r);n===-1&&(n=t.text.length);let s=t.text.substring(t.firstNonWhitespaceCharacterIndex,e);s.startsWith("require")&&(s=s.substring(7).trim());let i=t.text.substring(r,n);k(s[0])&&k(s[s.length-1])&&(s=s.substring(1,s.length-1)),k(i[0])&&k(i[i.length-1])&&(i=i.substring(1,i.length-1),r++,n--);let o=new _;return o.copyFrom(s,i,r,n,t.lineNumber,t.range.end.character),o}var Ot=require("vscode");var Dn=S(require("path")),pr=S(require("fs")),Vn=class{constructor(){this.inDependencies=!1,this.items=[],this.bypass=!1,this.yamlLines=[],this.dependencyDepth=0}},Ke=class{constructor(e,r,n,s){this.keys=e;this.enableLockFileParsing=r;this.lockFileName=n;this.lockParser=s;this.state=new Vn}parse(e){let r=jr==="npm"?f.npm.ignoreLinePattern:f.php.ignoreLinePattern;for(let n=0;n<e.lineCount;n++){let s=e.lineAt(n);if(!ue(s,r)&&!this.state.bypass){if(this.isDependencies(s)){this.state.inDependencies=!0,this.state.dependencyDepth=0;continue}if(this.state.inDependencies){if(bp(s)&&this.state.dependencyDepth++,yp(s)){this.state.dependencyDepth>0?this.state.dependencyDepth--:this.state.inDependencies=!1;continue}let i=Rp(s);if(i.value===""&&i.start===i.end)continue;this.addDependency(i)}}}return this.enableLockFileParsing?this.parseLockedFile(this.state.items):this.state.items}addDependency(e){e.createRange(),e.createDecoRange(),this.state.items.push(e)}isDependencies(e){let r=e.firstNonWhitespaceCharacterIndex;return this.keys.some(n=>e.text.substring(r,r+n.length+3)===`"${n}":`&&!e.text.includes("}"))}parseLockedFile(e){let r=Ot.window.activeTextEditor?.document.uri.fsPath,n=Dn.default.dirname(r||"");try{let i=pr.readdirSync(n).find(o=>o===this.lockFileName);if(i){let o=Dn.default.join(n,i),c=pr.readFileSync(o,"utf8");e=this.lockParser.parse(c,e),Ot.commands.executeCommand("setContext","dependi.hasLockFile",!0)}else Ot.commands.executeCommand("setContext","dependi.hasLockFile",!1)}catch(s){console.error(s)}return e}};function yp(t){return t.text[t.firstNonWhitespaceCharacterIndex]==="}"}function bp(t){let e=t.text.trim();return e.includes(": {")||e.endsWith("{")}function Rp(t){let e=t.text.indexOf(":",t.firstNonWhitespaceCharacterIndex),r=e+3,n=t.text.indexOf('"',r);n===-1&&(n=t.text.length);let s=t.text.substring(t.firstNonWhitespaceCharacterIndex,e),i=t.text.substring(r,n);k(s[0])&&k(s[s.length-1])&&(s=s.substring(1,s.length-1)),k(i[0])&&k(i[i.length-1])&&(i=i.substring(1,i.length-1),r++,n--);let o=new _;return o.copyFrom(s,i,r,n,t.lineNumber,t.range.end.character),o}var $n=class{constructor(){this.lockedValue="",this.dependency=""}},Ye=class{constructor(){}parse(e,r){let n=JSON.parse(e),s=new $n;return this.processLockFileDependencies(n,r,s),r}processLockFileDependencies(e,r,n){}};function fr(t,e){let r=e.find(n=>n.key===t.dependency);r&&(r.lockedAt=t.lockedValue),t.lockedValue="",t.dependency=""}var dr=class extends Ye{constructor(){super()}processLockFileDependencies(e,r,n){for(let s in e.packages)s.startsWith("node_modules/")&&(n.dependency=s.replace("node_modules/",""),Oe(r,n.dependency)&&(n.lockedValue=e.packages[s].version,fr(n,r)))}};var Je=class extends Ke{constructor(){super(["catalog","catalogs","dependencies","devDependencies","peerDependencies","optionalDependencies"],f.npm.lockFileEnabled,"package-lock.json",new dr)}addDependency(e){["link:","catalog:","workspace:"].some(n=>e.value?.startsWith(n))||((e.value?.startsWith("jsr:")||e.value?.startsWith("npm:@jsr/"))&&(e.source="jsr"),e=Ip(e),e.createRange(),e.createDecoRange(),this.state.items.push(e))}};function Ip(t){let e=t.value;if(!e)return t;if(e.startsWith("npm:@jsr/")){let r=e.substring(4),n=r.lastIndexOf("@");if(n>0){let s=r.substring(0,n),i=r.substring(n+1);s="@"+s.substring(5).replace(/__/g,"/"),t.key=s,t.value=i,t.start=t.start+e.lastIndexOf(i),t.end=t.start+i.length}}else if(e.startsWith("npm:")){let r=e.substring(4),n=r.lastIndexOf("@");n>0&&(t.key=r.substring(0,n),t.value=r.substring(n+1),t.start=t.start+e.lastIndexOf(t.value),t.end=t.start+t.value.length)}else if(e.startsWith("jsr:@")){let r=e.substring(4),n=r.lastIndexOf("@");n>0&&(t.key=r.substring(0,n),t.value=r.substring(n+1),t.start=t.start+e.lastIndexOf(t.value),t.end=t.start+t.value.length)}else e.startsWith("jsr:")&&(t.value=e.substring(4),t.start=t.start+4);return t}var mr=class extends Ye{constructor(){super()}processLockFileDependencies(e,r,n){let s=[...e.packages,...e["packages-dev"]];for(let i=0;i<s.length;i++){let o=s[i];n.dependency=o.name,Oe(r,n.dependency)&&(n.lockedValue=o.version,fr(n,r))}}};var ze=class extends Ke{constructor(){super(["require","require-dev"],f.php.lockFileEnabled,"composer.lock",new mr)}addDependency(e){e.key!=="php"&&(e.createRange(),e.createDecoRange(),this.state.items.push(e))}};var Qe=class extends je{constructor(){super(f.python.ignoreLinePattern,f.python.lockFileEnabled)}addItem(e,r){!e.currentItem.isValid()||["python","requires-python"].includes(e.currentItem.key)||(e.currentItem.createRange(),e.currentItem.createDecoRange(),r.push(e.currentItem),e.currentItem=new _)}parsePair(e,r){let n=new _,s=e.indexOf("=");if(s===-1)return;let i=e.substring(0,s).indexOf("[");r=s+1;let o=e.indexOf("#");n.key=ur(e.substring(0,i>-1?i:s)),n.key=n.key.replace(".version","");let c=e.substring(s+1,o>-1?o:e.length),a=c.indexOf(",");if(n.value=ur(a>-1?c.substring(0,a):c),!(lr(n.value)||n.value.includes("path"))){if(e.indexOf("{")>-1)return _n(e,n),On(e,n),n.start>-1?n:void 0;if(n.start=e.indexOf(n.value),n.end=n.start+n.value.length,e[s-1]==="~"||e[s-1]===">"){let l=n.value.lastIndexOf("."),u=n.value.substring(l+1);isNaN(parseInt(u[0]))&&(l=n.value.substring(0,l).lastIndexOf(".")),l>-1&&(n.value=n.value.substring(0,l)+".*")}return n.start>-1?n:void 0}}isSubTable(e,r){return e.trim()==="]"?(r.isSubTable=!1,r.isSingle=!1,r.isMultipleDepTable=!1,r.bypass=!0,!1):e.endsWith(" = [")}};var Fn=class{constructor(){this.inCatalogs=!1,this.inCatalogBlock=!1,this.currentCatalogName="",this.items=[],this.catalogDepth=0,this.isSingleCatalog=!1}},hr=class{parse(e){let r=new Fn;for(let n=0;n<e.lineCount;n++){let s=e.lineAt(n);if(!ue(s,"",["#"])){if(vp(s)){r.inCatalogs=!0,r.catalogDepth=0,r.isSingleCatalog=s.text.trim()==="catalog:",r.isSingleCatalog&&(r.inCatalogBlock=!0);continue}if(r.inCatalogs){if(Oo(s)===0&&s.text.trim()!==""){r.inCatalogs=!1,r.inCatalogBlock=!1;continue}if(!r.isSingleCatalog&&xp(s)){r.inCatalogBlock=!0,r.currentCatalogName=Pp(s);continue}if(r.inCatalogBlock){let o=Tp(s);o&&o.key&&o.value&&r.items.push(o)}}}}return r.items}};function vp(t){let e=t.text.trim();return e==="catalogs:"||e==="catalog:"}function xp(t){let e=Oo(t),r=t.text.trim();return e===2&&r.endsWith(":")&&!r.includes(" ")}function Pp(t){return t.text.trim().slice(0,-1)}function Oo(t){return t.firstNonWhitespaceCharacterIndex}function Tp(t){let e=t.text.trim();if(!e||!e.includes(":"))return null;let r=e.indexOf(":"),n=e.substring(0,r).trim().replace(/['"]/g,""),s=e.substring(r+1).trim().replace(/['"]/g,"");if(s.includes("#")&&(s=s.substring(0,s.indexOf("#")).trim()),!n||!s)return null;let i=t.text.indexOf(s),o=i+s.length,c=new _;return c.copyFrom(n,s,i,o,t.lineNumber,t.range.end.character),c.createRange(),c.createDecoRange(),c}var Ie=S(require("path")),gr=require("os"),Un=require("fs"),Ze=S(require("fs"));var _t=class extends ee{constructor(r,n){super(r,n);this.fetcher=r;this.parser=n;this.alternateRegistries=[]}async loadAlternateRegistries(r){let n;try{let i=Ie.default.join((0,gr.homedir)(),".cargo","credentials.toml");if(Ze.default.existsSync(i)){let o=await Un.promises.readFile(i,"utf-8");n=kn(o)}}catch(i){console.error(i)}let s;try{let i=Ie.default.dirname(r.document.uri.fsPath),o=null;for(let c=0;c<5;c++){let a=Ie.default.join(i,".cargo","config.toml"),l=Ie.default.join(i,".cargo","config");if(Ze.default.existsSync(a)){o=a;break}else if(Ze.default.existsSync(l)){o=l;break}let u=Ie.default.dirname(i);if(u===i)break;i=u}if(!o){let c=Ie.default.join((0,gr.homedir)(),".cargo","config"),a=Ie.default.join((0,gr.homedir)(),".cargo","config.toml");Ze.default.existsSync(a)?o=a:Ze.default.existsSync(c)&&(o=c)}if(o){let c=await Un.promises.readFile(o,"utf-8");s=kn(c)}}catch(i){console.error(i)}s&&(s=s.map(i=>{if(i.token===void 0){let o=n?.find(c=>c.name==i.name)?.token;return o&&(i.token=o),i}else return i}),this.alternateRegistries=s)}async parseAndDecorate(r){try{this.alternateRegistries.length===0&&await this.loadAlternateRegistries(r);let n=this.parse(r),s=n.filter(l=>!l.item.registry||l.item.registry==="crates-io"),i=n.filter(l=>l.item.registry&&l.item.registry!=="crates-io"),o=[],c=this.fetcher instanceof Le;if(s.length>0&&(c?(o.push(this.fetcher.fetchVersionsWithRegistries(s,this.alternateRegistries)),f.vulnerability.enabled&&o.push(this.fetcher.vulns(s))):o.push(this.fetcher.versions(s))),i.length>0){let l=c?this.fetcher:new Le(f.rust.index,"");o.push(l.fetchVersionsWithRegistries(i,this.alternateRegistries)),f.vulnerability.enabled&&o.push(l.vulns(i))}await Promise.all(o);let a=s.concat(i);O.updateAllData=a.map(l=>({key:l.item.key,version:this.buildVersionWithPrefix(l),startLine:l.item.range.start.line})),le(r,a,y),f.vulnerability.enabled&&c&&this.fetcher.vulns(a).then(()=>{le(r,a,y)})}catch(n){console.error(n)}}};var Er=class extends ee{async parseAndDecorate(e){try{let r=this.parse(e);f.npm.jsrEnabled||(r=r.filter(s=>s.item.source!=="jsr"));let n=await this.fetcher.versions(r);O.updateAllData=r.map(s=>({key:s.item.key,version:this.buildVersionWithPrefix(s),startLine:s.item.range.start.line})),le(e,n,y)}catch(r){console.error(r),P.appendLine(`Failed to parse and decorate ${r}`)}}};var yr=class extends ee{};var _o=(t,e)=>new Promise(function(r,n){let s=Lp(t),i=q(s);i.headers={...i.headers,Accept:"application/json"},W(i,(c,a)=>{if(B(c))return n(M(c));var l;let u=Y(t,c,a,n);c.on("end",()=>{try{let p=JSON.parse(Buffer.concat(u).toString()),d=[],m="";p.versions&&(d=Object.keys(p.versions).filter(b=>!p.versions[b].yanked)),l={name:t,versions:d,latestVersion:p.latest,error:m}}catch(p){console.error("Error parsing response:",p),n(p)}r(l)})},n)});function Lp(t){return`${f.npm.jsrIndex}/${t}/meta.json`}var br=class extends ${fetch(e){let r=this;return async function(n){return _o(n.item.key,n.item.value).then(i=>{let o=i.versions.filter(c=>c!==""&&c!==void 0&&!r.checkUnstables(f.npm.unstableFilter,c,n.item.value)).sort(V).reverse();return n.versions=o,n.item.latestVersion=i.latestVersion,n.item.value=n.item.value==="latest"?i.latestVersion:n.item.value,n.error=i.error,n}).catch(j(n))}}};var he=class extends ee{constructor(e,r,n){super(e,r),this.lang=n}};var Rr=class extends he{constructor(r,n){super(r,n,3);this.fetcher=r;this.parser=n}async parseAndDecorate(r){try{let n=this.parse(r),s=[],i=[];f.npm.jsrEnabled?(s=n.filter(a=>a.item.source==="jsr"),i=n.filter(a=>a.item.source!=="jsr")):i=n.filter(a=>a.item.source!=="jsr");let o=[];if(i.length>0&&(o.push(this.fetcher.versions(i)),f.vulnerability.enabled&&o.push(this.fetcher.vulns(i))),f.npm.jsrEnabled&&s.length>0){let a=new br(f.npm.jsrIndex,"dependi.npm.jsrIndexServerURL");o.push(a.versions(s))}await Promise.all(o);let c=i.concat(s);O.updateAllData=c.map(a=>({key:a.item.key,version:this.buildVersionWithPrefix(a),startLine:a.item.range.start.line})),le(r,c,y),f.vulnerability.enabled&&this.fetcher.vulns(c).then(()=>{le(r,c,y)})}catch(n){console.error(n)}}};var Ir=class extends he{constructor(r,n){super(r,n,5);this.fetcher=r;this.parser=n}};var vr=class extends ee{constructor(e,r){super(e,r)}};var xr=class extends ee{modifyDependecy(e){let r=Se(e.item.value??""),n=Ne(r,e.versions??[]);e.item.value=n||e.item.value}};var Pr=class extends he{constructor(r,n){super(r,n,6);this.fetcher=r;this.parser=n}};var Co=t=>new Promise(function(e,r){let n=wp(t),s=q(n);W(s,(o,c)=>{if(B(o))return r(M(o));let a=Y(t,o,c,r),l;o.on("end",()=>{try{let p=JSON.parse(Buffer.concat(a).toString()).versions,d=Object.keys(p).map(m=>p[m].version);l={name:t,versions:d}}catch(u){r(u)}e(l)})},r)});function wp(t){return F(`${f.dart.index}/api/packages/${t}`)}var Tr=class extends ${fetch(){let e=this;return async function(r){return Co(r.item.key).then(n=>{let s=n.versions.filter(i=>i!==""&&i!==void 0&&!e.checkUnstables(f.dart.unstableFilter,i,r.item.value)).sort(V).reverse();return r.versions=s,r}).catch(j(r))}}};var Ct=require("vscode");var Mn=S(require("path")),Bn=S(require("fs"));var qn=class{constructor(){this.lockedValue="",this.dependency=""}},Lr=class{constructor(){}parse(e,r){let n=e.split(`
`),s=new qn;for(let i=0;i<n.length;i++){let o=n[i];if(o.trim().startsWith("name:")&&(s.dependency=this.getPackageName(o),Oe(r,s.dependency))){for(i++;i<n.length;i++)if(o=n[i],o.trim().startsWith("version:")){s.lockedValue=this.getParsedVersion(o),Ln(s,r),i++;break}}}return r}getPackageName(e){let r=e.split("name:")[1];return wt(r)}getParsedVersion(e){let r=e.split("version:")[1];return wt(r)}};var et=class{parse(e){let r=[],n=!1;for(let s=0;s<e.lineCount;s++){let i=e.lineAt(s);if(ue(i,f.dart.ignoreLinePattern,["#"]))continue;let o=i.firstNonWhitespaceCharacterIndex;if(o===0)n=Sp(i);else if(n&&o===2){let c=Np(i);c&&r.push(c)}}return f.dart.lockFileEnabled?_p(r):r}};function Sp(t){let e=["dependencies:","dev_dependencies:"],r=t.text.trim();return e.some(n=>r===n)}function Np(t){let e=new _,r=t.text,n=r.indexOf(":");if(n===-1)return;e.key=r.substring(0,n).trim();let s=r.substring(n+1).trim(),i=s.indexOf("#"),o=i!==-1?s.substring(0,i).trim():s;if(e.value=o,e.start=t.text.indexOf(o,n+1),e.end=e.start+o.length,k(o[0])&&k(o[o.length-1])&&(e.value=o.substring(1,o.length-1),e.start+=1,e.end-=1),!!Op(e.value))return e.line=t.lineNumber,e.endOfLine=t.range.end.character,e.createRange(),e.createDecoRange(),e}function Op(t){if(!t||t===void 0)return!1;if(t==="any")return!0;let e=t.split(/\s+/).filter(n=>n.length>0);if(e.length===0)return!1;let r=/^[<>~=^]?=?\s*\d+(\.\d+)*([\-+]?\w+)*$/;return e.every(n=>r.test(n))}function _p(t){let e=Ct.window.activeTextEditor?.document.uri.fsPath,r=Mn.default.dirname(e||"");try{let s=Bn.default.readdirSync(r).find(i=>i.endsWith(".lock"));if(s){let i=Mn.default.join(r,s),o=Bn.default.readFileSync(i,"utf8");t=new Lr().parse(o,t),Ct.commands.executeCommand("setContext","dependi.hasLockFile",!0)}else Ct.commands.executeCommand("setContext","dependi.hasLockFile",!1)}catch(n){console.error(n)}return t}var ko=t=>new Promise(function(e,r){let n=Cp(t),s=q(n);W(s,(o,c)=>{if(B(o))return r(M(o));let{body:a,stream:l}=ls(t,o,c,r),u;l.on("end",()=>{try{let p=JSON.parse(Buffer.concat(a).toString());u={name:t,versions:p.items.flatMap(d=>d.items||[]).filter(d=>d?.catalogEntry?.version).map(d=>d.catalogEntry.version)}}catch(p){r(p)}e(u)})},r)});function Cp(t){return F(`${f.csharp.index}/v3/registration5-gz-semver2/${t.toLowerCase()}/index.json`)}var wr=class extends ${fetch(){let e=this;return function(r){return r.versions&&r.versions.length>0?Promise.resolve(r):ko(r.item.key).then(n=>{let s=n.versions.filter(i=>i!==""&&i!==void 0&&!e.checkUnstables(f.csharp.unstableFilter,i,r.item.value)).sort(V).reverse();return r.versions=s,r}).catch(j(r))}}};var Ao=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",kp=Ao+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",Ap="["+Ao+"]["+kp+"]*",Dp=new RegExp("^"+Ap+"$");function Sr(t,e){let r=[],n=e.exec(t);for(;n;){let s=[];s.startIndex=e.lastIndex-n[0].length;let i=n.length;for(let o=0;o<i;o++)s.push(n[o]);r.push(s),n=e.exec(t)}return r}var kt=function(t){let e=Dp.exec(t);return!(e===null||typeof e>"u")};function Do(t){return typeof t<"u"}var Vp={allowBooleanAttributes:!1,unpairedTags:[]};function qo(t,e){e=Object.assign({},Vp,e);let r=[],n=!1,s=!1;t[0]==="\uFEFF"&&(t=t.substr(1));for(let i=0;i<t.length;i++)if(t[i]==="<"&&t[i+1]==="?"){if(i+=2,i=$o(t,i),i.err)return i}else if(t[i]==="<"){let o=i;if(i++,t[i]==="!"){i=Fo(t,i);continue}else{let c=!1;t[i]==="/"&&(c=!0,i++);let a="";for(;i<t.length&&t[i]!==">"&&t[i]!==" "&&t[i]!=="	"&&t[i]!==`
`&&t[i]!=="\r";i++)a+=t[i];if(a=a.trim(),a[a.length-1]==="/"&&(a=a.substring(0,a.length-1),i--),!Hp(a)){let p;return a.trim().length===0?p="Invalid space after '<'.":p="Tag '"+a+"' is an invalid name.",A("InvalidTag",p,Q(t,i))}let l=Up(t,i);if(l===!1)return A("InvalidAttr","Attributes for '"+a+"' have open quote.",Q(t,i));let u=l.value;if(i=l.index,u[u.length-1]==="/"){let p=i-u.length;u=u.substring(0,u.length-1);let d=Uo(u,e);if(d===!0)n=!0;else return A(d.err.code,d.err.msg,Q(t,p+d.err.line))}else if(c)if(l.tagClosed){if(u.trim().length>0)return A("InvalidTag","Closing tag '"+a+"' can't have attributes or invalid starting.",Q(t,o));if(r.length===0)return A("InvalidTag","Closing tag '"+a+"' has not been opened.",Q(t,o));{let p=r.pop();if(a!==p.tagName){let d=Q(t,p.tagStartPos);return A("InvalidTag","Expected closing tag '"+p.tagName+"' (opened in line "+d.line+", col "+d.col+") instead of closing tag '"+a+"'.",Q(t,o))}r.length==0&&(s=!0)}}else return A("InvalidTag","Closing tag '"+a+"' doesn't have proper closing.",Q(t,i));else{let p=Uo(u,e);if(p!==!0)return A(p.err.code,p.err.msg,Q(t,i-u.length+p.err.line));if(s===!0)return A("InvalidXml","Multiple possible root nodes found.",Q(t,i));e.unpairedTags.indexOf(a)!==-1||r.push({tagName:a,tagStartPos:o}),n=!0}for(i++;i<t.length;i++)if(t[i]==="<")if(t[i+1]==="!"){i++,i=Fo(t,i);continue}else if(t[i+1]==="?"){if(i=$o(t,++i),i.err)return i}else break;else if(t[i]==="&"){let p=Bp(t,i);if(p==-1)return A("InvalidChar","char '&' is not expected.",Q(t,i));i=p}else if(s===!0&&!Vo(t[i]))return A("InvalidXml","Extra text at the end",Q(t,i));t[i]==="<"&&i--}}else{if(Vo(t[i]))continue;return A("InvalidChar","char '"+t[i]+"' is not expected.",Q(t,i))}if(n){if(r.length==1)return A("InvalidTag","Unclosed tag '"+r[0].tagName+"'.",Q(t,r[0].tagStartPos));if(r.length>0)return A("InvalidXml","Invalid '"+JSON.stringify(r.map(i=>i.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return A("InvalidXml","Start tag expected.",1);return!0}function Vo(t){return t===" "||t==="	"||t===`
`||t==="\r"}function $o(t,e){let r=e;for(;e<t.length;e++)if(t[e]=="?"||t[e]==" "){let n=t.substr(r,e-r);if(e>5&&n==="xml")return A("InvalidXml","XML declaration allowed only at the start of the document.",Q(t,e));if(t[e]=="?"&&t[e+1]==">"){e++;break}else continue}return e}function Fo(t,e){if(t.length>e+5&&t[e+1]==="-"&&t[e+2]==="-"){for(e+=3;e<t.length;e++)if(t[e]==="-"&&t[e+1]==="-"&&t[e+2]===">"){e+=2;break}}else if(t.length>e+8&&t[e+1]==="D"&&t[e+2]==="O"&&t[e+3]==="C"&&t[e+4]==="T"&&t[e+5]==="Y"&&t[e+6]==="P"&&t[e+7]==="E"){let r=1;for(e+=8;e<t.length;e++)if(t[e]==="<")r++;else if(t[e]===">"&&(r--,r===0))break}else if(t.length>e+9&&t[e+1]==="["&&t[e+2]==="C"&&t[e+3]==="D"&&t[e+4]==="A"&&t[e+5]==="T"&&t[e+6]==="A"&&t[e+7]==="["){for(e+=8;e<t.length;e++)if(t[e]==="]"&&t[e+1]==="]"&&t[e+2]===">"){e+=2;break}}return e}var $p='"',Fp="'";function Up(t,e){let r="",n="",s=!1;for(;e<t.length;e++){if(t[e]===$p||t[e]===Fp)n===""?n=t[e]:n!==t[e]||(n="");else if(t[e]===">"&&n===""){s=!0;break}r+=t[e]}return n!==""?!1:{value:r,index:e,tagClosed:s}}var qp=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function Uo(t,e){let r=Sr(t,qp),n={};for(let s=0;s<r.length;s++){if(r[s][1].length===0)return A("InvalidAttr","Attribute '"+r[s][2]+"' has no space in starting.",At(r[s]));if(r[s][3]!==void 0&&r[s][4]===void 0)return A("InvalidAttr","Attribute '"+r[s][2]+"' is without value.",At(r[s]));if(r[s][3]===void 0&&!e.allowBooleanAttributes)return A("InvalidAttr","boolean attribute '"+r[s][2]+"' is not allowed.",At(r[s]));let i=r[s][2];if(!Wp(i))return A("InvalidAttr","Attribute '"+i+"' is an invalid name.",At(r[s]));if(!n.hasOwnProperty(i))n[i]=1;else return A("InvalidAttr","Attribute '"+i+"' is repeated.",At(r[s]))}return!0}function Mp(t,e){let r=/\d/;for(t[e]==="x"&&(e++,r=/[\da-fA-F]/);e<t.length;e++){if(t[e]===";")return e;if(!t[e].match(r))break}return-1}function Bp(t,e){if(e++,t[e]===";")return-1;if(t[e]==="#")return e++,Mp(t,e);let r=0;for(;e<t.length;e++,r++)if(!(t[e].match(/\w/)&&r<20)){if(t[e]===";")break;return-1}return e}function A(t,e,r){return{err:{code:t,msg:e,line:r.line||r,col:r.col}}}function Wp(t){return kt(t)}function Hp(t){return kt(t)}function Q(t,e){let r=t.substring(0,e).split(/\r?\n/);return{line:r.length,col:r[r.length-1].length+1}}function At(t){return t.startIndex+t[1].length}var jp={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(t,e){return e},attributeValueProcessor:function(t,e){return e},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(t,e,r){return t},captureMetaData:!1},Mo=function(t){return Object.assign({},jp,t)};var Nr;typeof Symbol!="function"?Nr="@@xmlMetadata":Nr=Symbol("XML Node Metadata");var ie=class{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,r){e==="__proto__"&&(e="#__proto__"),this.child.push({[e]:r})}addChild(e,r){e.tagname==="__proto__"&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child}),r!==void 0&&(this.child[this.child.length-1][Nr]={startIndex:r})}static getMetaDataSymbol(){return Nr}};function Wn(t,e){let r={};if(t[e+3]==="O"&&t[e+4]==="C"&&t[e+5]==="T"&&t[e+6]==="Y"&&t[e+7]==="P"&&t[e+8]==="E"){e=e+9;let n=1,s=!1,i=!1,o="";for(;e<t.length;e++)if(t[e]==="<"&&!i){if(s&&_e(t,"!ENTITY",e)){e+=7;let c,a;[c,a,e]=Gp(t,e+1),a.indexOf("&")===-1&&(r[c]={regx:RegExp(`&${c};`,"g"),val:a})}else if(s&&_e(t,"!ELEMENT",e)){e+=8;let{index:c}=Kp(t,e+1);e=c}else if(s&&_e(t,"!ATTLIST",e))e+=8;else if(s&&_e(t,"!NOTATION",e)){e+=9;let{index:c}=Xp(t,e+1);e=c}else if(_e(t,"!--",e))i=!0;else throw new Error("Invalid DOCTYPE");n++,o=""}else if(t[e]===">"){if(i?t[e-1]==="-"&&t[e-2]==="-"&&(i=!1,n--):n--,n===0)break}else t[e]==="["?s=!0:o+=t[e];if(n!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:r,i:e}}var ve=(t,e)=>{for(;e<t.length&&/\s/.test(t[e]);)e++;return e};function Gp(t,e){e=ve(t,e);let r="";for(;e<t.length&&!/\s/.test(t[e])&&t[e]!=='"'&&t[e]!=="'";)r+=t[e],e++;if(Hn(r),e=ve(t,e),t.substring(e,e+6).toUpperCase()==="SYSTEM")throw new Error("External entities are not supported");if(t[e]==="%")throw new Error("Parameter entities are not supported");let n="";return[e,n]=Or(t,e,"entity"),e--,[r,n,e]}function Xp(t,e){e=ve(t,e);let r="";for(;e<t.length&&!/\s/.test(t[e]);)r+=t[e],e++;Hn(r),e=ve(t,e);let n=t.substring(e,e+6).toUpperCase();if(n!=="SYSTEM"&&n!=="PUBLIC")throw new Error(`Expected SYSTEM or PUBLIC, found "${n}"`);e+=n.length,e=ve(t,e);let s=null,i=null;if(n==="PUBLIC")[e,s]=Or(t,e,"publicIdentifier"),e=ve(t,e),(t[e]==='"'||t[e]==="'")&&([e,i]=Or(t,e,"systemIdentifier"));else if(n==="SYSTEM"&&([e,i]=Or(t,e,"systemIdentifier"),!i))throw new Error("Missing mandatory system identifier for SYSTEM notation");return{notationName:r,publicIdentifier:s,systemIdentifier:i,index:--e}}function Or(t,e,r){let n="",s=t[e];if(s!=='"'&&s!=="'")throw new Error(`Expected quoted string, found "${s}"`);for(e++;e<t.length&&t[e]!==s;)n+=t[e],e++;if(t[e]!==s)throw new Error(`Unterminated ${r} value`);return e++,[e,n]}function Kp(t,e){e=ve(t,e);let r="";for(;e<t.length&&!/\s/.test(t[e]);)r+=t[e],e++;if(!Hn(r))throw new Error(`Invalid element name: "${r}"`);e=ve(t,e);let n="";if(t[e]==="E"&&_e(t,"MPTY",e))e+=4;else if(t[e]==="A"&&_e(t,"NY",e))e+=2;else if(t[e]==="("){for(e++;e<t.length&&t[e]!==")";)n+=t[e],e++;if(t[e]!==")")throw new Error("Unterminated content model")}else throw new Error(`Invalid Element Expression, found "${t[e]}"`);return{elementName:r,contentModel:n.trim(),index:e}}function _e(t,e,r){for(let n=0;n<e.length;n++)if(e[n]!==t[r+n+1])return!1;return!0}function Hn(t){if(kt(t))return t;throw new Error(`Invalid entity name ${t}`)}var Yp=/^[-+]?0x[a-fA-F0-9]+$/,Jp=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,zp={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function jn(t,e={}){if(e=Object.assign({},zp,e),!t||typeof t!="string")return t;let r=t.trim();if(e.skipLike!==void 0&&e.skipLike.test(r))return t;if(t==="0")return 0;if(e.hex&&Yp.test(r))return tf(r,16);if(r.search(/.+[eE].+/)!==-1)return Zp(t,r,e);{let n=Jp.exec(r);if(n){let s=n[1]||"",i=n[2],o=ef(n[3]),c=s?t[i.length+1]===".":t[i.length]===".";if(!e.leadingZeros&&(i.length>1||i.length===1&&!c))return t;{let a=Number(r),l=String(a);if(a===0)return a;if(l.search(/[eE]/)!==-1)return e.eNotation?a:t;if(r.indexOf(".")!==-1)return l==="0"||l===o||l===`${s}${o}`?a:t;let u=i?o:r;return i?u===l||s+u===l?a:t:u===l||u===s+l?a:t}}else return t}}var Qp=/^([-+])?(0*)(\d*(\.\d*)?[eE][-\+]?\d+)$/;function Zp(t,e,r){if(!r.eNotation)return t;let n=e.match(Qp);if(n){let s=n[1]||"",i=n[3].indexOf("e")===-1?"E":"e",o=n[2],c=s?t[o.length+1]===i:t[o.length]===i;return o.length>1&&c?t:o.length===1&&(n[3].startsWith(`.${i}`)||n[3][0]===i)?Number(e):r.leadingZeros&&!c?(e=(n[1]||"")+n[3],Number(e)):t}else return t}function ef(t){return t&&t.indexOf(".")!==-1&&(t=t.replace(/0+$/,""),t==="."?t="0":t[0]==="."?t="0"+t:t[t.length-1]==="."&&(t=t.substring(0,t.length-1))),t}function tf(t,e){if(parseInt)return parseInt(t,e);if(Number.parseInt)return Number.parseInt(t,e);if(window&&window.parseInt)return window.parseInt(t,e);throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}function Gn(t){return typeof t=="function"?t:Array.isArray(t)?e=>{for(let r of t)if(typeof r=="string"&&e===r||r instanceof RegExp&&r.test(e))return!0}:()=>!1}var Dt=class{constructor(e){this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"\xA2"},pound:{regex:/&(pound|#163);/g,val:"\xA3"},yen:{regex:/&(yen|#165);/g,val:"\xA5"},euro:{regex:/&(euro|#8364);/g,val:"\u20AC"},copyright:{regex:/&(copy|#169);/g,val:"\xA9"},reg:{regex:/&(reg|#174);/g,val:"\xAE"},inr:{regex:/&(inr|#8377);/g,val:"\u20B9"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(r,n)=>String.fromCodePoint(Number.parseInt(n,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(r,n)=>String.fromCodePoint(Number.parseInt(n,16))}},this.addExternalEntities=rf,this.parseXml=cf,this.parseTextData=nf,this.resolveNameSpace=sf,this.buildAttributesMap=af,this.isItStopNode=ff,this.replaceEntitiesValue=uf,this.readStopNodeData=mf,this.saveTextToParentTag=pf,this.addChild=lf,this.ignoreAttributesFn=Gn(this.options.ignoreAttributes)}};function rf(t){let e=Object.keys(t);for(let r=0;r<e.length;r++){let n=e[r];this.lastEntities[n]={regex:new RegExp("&"+n+";","g"),val:t[n]}}}function nf(t,e,r,n,s,i,o){if(t!==void 0&&(this.options.trimValues&&!n&&(t=t.trim()),t.length>0)){o||(t=this.replaceEntitiesValue(t));let c=this.options.tagValueProcessor(e,t,r,s,i);return c==null?t:typeof c!=typeof t||c!==t?c:this.options.trimValues?Kn(t,this.options.parseTagValue,this.options.numberParseOptions):t.trim()===t?Kn(t,this.options.parseTagValue,this.options.numberParseOptions):t}}function sf(t){if(this.options.removeNSPrefix){let e=t.split(":"),r=t.charAt(0)==="/"?"/":"";if(e[0]==="xmlns")return"";e.length===2&&(t=r+e[1])}return t}var of=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function af(t,e,r){if(this.options.ignoreAttributes!==!0&&typeof t=="string"){let n=Sr(t,of),s=n.length,i={};for(let o=0;o<s;o++){let c=this.resolveNameSpace(n[o][1]);if(this.ignoreAttributesFn(c,e))continue;let a=n[o][4],l=this.options.attributeNamePrefix+c;if(c.length)if(this.options.transformAttributeName&&(l=this.options.transformAttributeName(l)),l==="__proto__"&&(l="#__proto__"),a!==void 0){this.options.trimValues&&(a=a.trim()),a=this.replaceEntitiesValue(a);let u=this.options.attributeValueProcessor(c,a,e);u==null?i[l]=a:typeof u!=typeof a||u!==a?i[l]=u:i[l]=Kn(a,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(i[l]=!0)}if(!Object.keys(i).length)return;if(this.options.attributesGroupName){let o={};return o[this.options.attributesGroupName]=i,o}return i}}var cf=function(t){t=t.replace(/\r\n?/g,`
`);let e=new ie("!xml"),r=e,n="",s="";for(let i=0;i<t.length;i++)if(t[i]==="<")if(t[i+1]==="/"){let c=Ce(t,">",i,"Closing Tag is not closed."),a=t.substring(i+2,c).trim();if(this.options.removeNSPrefix){let p=a.indexOf(":");p!==-1&&(a=a.substr(p+1))}this.options.transformTagName&&(a=this.options.transformTagName(a)),r&&(n=this.saveTextToParentTag(n,r,s));let l=s.substring(s.lastIndexOf(".")+1);if(a&&this.options.unpairedTags.indexOf(a)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${a}>`);let u=0;l&&this.options.unpairedTags.indexOf(l)!==-1?(u=s.lastIndexOf(".",s.lastIndexOf(".")-1),this.tagsNodeStack.pop()):u=s.lastIndexOf("."),s=s.substring(0,u),r=this.tagsNodeStack.pop(),n="",i=c}else if(t[i+1]==="?"){let c=Xn(t,i,!1,"?>");if(!c)throw new Error("Pi Tag is not closed.");if(n=this.saveTextToParentTag(n,r,s),!(this.options.ignoreDeclaration&&c.tagName==="?xml"||this.options.ignorePiTags)){let a=new ie(c.tagName);a.add(this.options.textNodeName,""),c.tagName!==c.tagExp&&c.attrExpPresent&&(a[":@"]=this.buildAttributesMap(c.tagExp,s,c.tagName)),this.addChild(r,a,s,i)}i=c.closeIndex+1}else if(t.substr(i+1,3)==="!--"){let c=Ce(t,"-->",i+4,"Comment is not closed.");if(this.options.commentPropName){let a=t.substring(i+4,c-2);n=this.saveTextToParentTag(n,r,s),r.add(this.options.commentPropName,[{[this.options.textNodeName]:a}])}i=c}else if(t.substr(i+1,2)==="!D"){let c=Wn(t,i);this.docTypeEntities=c.entities,i=c.i}else if(t.substr(i+1,2)==="!["){let c=Ce(t,"]]>",i,"CDATA is not closed.")-2,a=t.substring(i+9,c);n=this.saveTextToParentTag(n,r,s);let l=this.parseTextData(a,r.tagname,s,!0,!1,!0,!0);l==null&&(l=""),this.options.cdataPropName?r.add(this.options.cdataPropName,[{[this.options.textNodeName]:a}]):r.add(this.options.textNodeName,l),i=c+2}else{let c=Xn(t,i,this.options.removeNSPrefix),a=c.tagName,l=c.rawTagName,u=c.tagExp,p=c.attrExpPresent,d=c.closeIndex;this.options.transformTagName&&(a=this.options.transformTagName(a)),r&&n&&r.tagname!=="!xml"&&(n=this.saveTextToParentTag(n,r,s,!1));let m=r;m&&this.options.unpairedTags.indexOf(m.tagname)!==-1&&(r=this.tagsNodeStack.pop(),s=s.substring(0,s.lastIndexOf("."))),a!==e.tagname&&(s+=s?"."+a:a);let b=i;if(this.isItStopNode(this.options.stopNodes,s,a)){let I="";if(u.length>0&&u.lastIndexOf("/")===u.length-1)a[a.length-1]==="/"?(a=a.substr(0,a.length-1),s=s.substr(0,s.length-1),u=a):u=u.substr(0,u.length-1),i=c.closeIndex;else if(this.options.unpairedTags.indexOf(a)!==-1)i=c.closeIndex;else{let D=this.readStopNodeData(t,l,d+1);if(!D)throw new Error(`Unexpected end of ${l}`);i=D.i,I=D.tagContent}let K=new ie(a);a!==u&&p&&(K[":@"]=this.buildAttributesMap(u,s,a)),I&&(I=this.parseTextData(I,a,s,!0,p,!0,!0)),s=s.substr(0,s.lastIndexOf(".")),K.add(this.options.textNodeName,I),this.addChild(r,K,s,b)}else{if(u.length>0&&u.lastIndexOf("/")===u.length-1){a[a.length-1]==="/"?(a=a.substr(0,a.length-1),s=s.substr(0,s.length-1),u=a):u=u.substr(0,u.length-1),this.options.transformTagName&&(a=this.options.transformTagName(a));let I=new ie(a);a!==u&&p&&(I[":@"]=this.buildAttributesMap(u,s,a)),this.addChild(r,I,s,b),s=s.substr(0,s.lastIndexOf("."))}else{let I=new ie(a);this.tagsNodeStack.push(r),a!==u&&p&&(I[":@"]=this.buildAttributesMap(u,s,a)),this.addChild(r,I,s,b),r=I}n="",i=d}}else n+=t[i];return e.child};function lf(t,e,r,n){this.options.captureMetaData||(n=void 0);let s=this.options.updateTag(e.tagname,r,e[":@"]);s===!1||(typeof s=="string"&&(e.tagname=s),t.addChild(e,n))}var uf=function(t){if(this.options.processEntities){for(let e in this.docTypeEntities){let r=this.docTypeEntities[e];t=t.replace(r.regx,r.val)}for(let e in this.lastEntities){let r=this.lastEntities[e];t=t.replace(r.regex,r.val)}if(this.options.htmlEntities)for(let e in this.htmlEntities){let r=this.htmlEntities[e];t=t.replace(r.regex,r.val)}t=t.replace(this.ampEntity.regex,this.ampEntity.val)}return t};function pf(t,e,r,n){return t&&(n===void 0&&(n=e.child.length===0),t=this.parseTextData(t,e.tagname,r,!1,e[":@"]?Object.keys(e[":@"]).length!==0:!1,n),t!==void 0&&t!==""&&e.add(this.options.textNodeName,t),t=""),t}function ff(t,e,r){let n="*."+r;for(let s in t){let i=t[s];if(n===i||e===i)return!0}return!1}function df(t,e,r=">"){let n,s="";for(let i=e;i<t.length;i++){let o=t[i];if(n)o===n&&(n="");else if(o==='"'||o==="'")n=o;else if(o===r[0])if(r[1]){if(t[i+1]===r[1])return{data:s,index:i}}else return{data:s,index:i};else o==="	"&&(o=" ");s+=o}}function Ce(t,e,r,n){let s=t.indexOf(e,r);if(s===-1)throw new Error(n);return s+e.length-1}function Xn(t,e,r,n=">"){let s=df(t,e+1,n);if(!s)return;let i=s.data,o=s.index,c=i.search(/\s/),a=i,l=!0;c!==-1&&(a=i.substring(0,c),i=i.substring(c+1).trimStart());let u=a;if(r){let p=a.indexOf(":");p!==-1&&(a=a.substr(p+1),l=a!==s.data.substr(p+1))}return{tagName:a,tagExp:i,closeIndex:o,attrExpPresent:l,rawTagName:u}}function mf(t,e,r){let n=r,s=1;for(;r<t.length;r++)if(t[r]==="<")if(t[r+1]==="/"){let i=Ce(t,">",r,`${e} is not closed`);if(t.substring(r+2,i).trim()===e&&(s--,s===0))return{tagContent:t.substring(n,r),i};r=i}else if(t[r+1]==="?")r=Ce(t,"?>",r+1,"StopNode is not closed.");else if(t.substr(r+1,3)==="!--")r=Ce(t,"-->",r+3,"StopNode is not closed.");else if(t.substr(r+1,2)==="![")r=Ce(t,"]]>",r,"StopNode is not closed.")-2;else{let i=Xn(t,r,">");i&&((i&&i.tagName)===e&&i.tagExp[i.tagExp.length-1]!=="/"&&s++,r=i.closeIndex)}}function Kn(t,e,r){if(e&&typeof t=="string"){let n=t.trim();return n==="true"?!0:n==="false"?!1:jn(t,r)}else return Do(t)?t:""}var Yn=ie.getMetaDataSymbol();function Jn(t,e){return Bo(t,e)}function Bo(t,e,r){let n,s={};for(let i=0;i<t.length;i++){let o=t[i],c=hf(o),a="";if(r===void 0?a=c:a=r+"."+c,c===e.textNodeName)n===void 0?n=o[c]:n+=""+o[c];else{if(c===void 0)continue;if(o[c]){let l=Bo(o[c],e,a),u=Ef(l,e);o[Yn]!==void 0&&(l[Yn]=o[Yn]),o[":@"]?gf(l,o[":@"],a,e):Object.keys(l).length===1&&l[e.textNodeName]!==void 0&&!e.alwaysCreateTextNode?l=l[e.textNodeName]:Object.keys(l).length===0&&(e.alwaysCreateTextNode?l[e.textNodeName]="":l=""),s[c]!==void 0&&s.hasOwnProperty(c)?(Array.isArray(s[c])||(s[c]=[s[c]]),s[c].push(l)):e.isArray(c,a,u)?s[c]=[l]:s[c]=l}}}return typeof n=="string"?n.length>0&&(s[e.textNodeName]=n):n!==void 0&&(s[e.textNodeName]=n),s}function hf(t){let e=Object.keys(t);for(let r=0;r<e.length;r++){let n=e[r];if(n!==":@")return n}}function gf(t,e,r,n){if(e){let s=Object.keys(e),i=s.length;for(let o=0;o<i;o++){let c=s[o];n.isArray(c,r+"."+c,!0,!0)?t[c]=[e[c]]:t[c]=e[c]}}}function Ef(t,e){let{textNodeName:r}=e,n=Object.keys(t).length;return!!(n===0||n===1&&(t[r]||typeof t[r]=="boolean"||t[r]===0))}var tt=class{constructor(e){this.externalEntities={},this.options=Mo(e)}parse(e,r){if(typeof e!="string")if(e.toString)e=e.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(r){r===!0&&(r={});let i=qo(e,r);if(i!==!0)throw Error(`${i.err.msg}:${i.err.line}:${i.err.col}`)}let n=new Dt(this.options);n.addExternalEntities(this.externalEntities);let s=n.parseXml(e);return this.options.preserveOrder||s===void 0?s:Jn(s,this.options)}addEntity(e,r){if(r.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(e.indexOf("&")!==-1||e.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(r==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=r}static getMetaDataSymbol(){return ie.getMetaDataSymbol()}};var yf={ignoreAttributes:!1,isArray:t=>t==="Project"||t==="ItemGroup"||t==="PackageVersion"||t==="PackageReference"},ke=class{parse(e){let i=(new tt(yf).parse(e.getText()).Project??[]).flatMap(d=>d.ItemGroup??[]),o=i.flatMap(d=>d.PackageVersion??[]),c=i.flatMap(d=>d.PackageReference??[]),a=o.concat(c).map(d=>({name:d["@_Include"],version:d["@_Version"]})).filter(d=>!!d.version).filter(d=>V.validate(d.version)),l=[],u="",p="";for(let d=0;d<e.lineCount;d++){let m=e.lineAt(d);if((m.text.includes("<PackageVersion")||m.text.includes("<PackageReference"))&&(u="",p=""),m.text.includes("Include=")){let b=/Include="([a-zA-z0-9.]+)"/.exec(m.text);u=b&&b[1]||u}if(m.text.includes("Version=")){let b=/Version="([0-9.]+)"/.exec(m.text);p=b&&b[1]||p}if(u&&p){if(!a.some(U=>U.name===u&&U.version===p))continue;let b=m.text.indexOf('Version="'),I=b!==-1?b+9:m.text.indexOf(p),K=I+p.length,D=new _;D.copyFrom(u,p,I,K,m.lineNumber,m.range.end.character),D.createRange(),D.createDecoRange(),l.push(D),u="",p=""}}return l}};var _r=class extends he{constructor(r,n){super(r,n,7);this.fetcher=r;this.parser=n}};var zn;async function te(t){return zn&&clearTimeout(zn),new Promise(e=>{zn=setTimeout(async()=>{await bf(t),e()},200)})}async function bf(t){if(!t||!t.document||t.document.isDirty)return console.debug("Editor is undefined or document is dirty",t,t?.document.isDirty),Promise.resolve();let e;switch(y){case 1:if(!f.rust.enabled)return;e=new _t(new Le(f.rust.index,"rust.indexServerURL"),new Ge);break;case 2:if(!f.go.enabled)return;e=new yr(new ir(f.go.index,"go.indexServerURL"),new Xe);break;case 3:if(!f.npm.enabled)return;e=new Rr(new Lt(f.npm.index,"npm.indexServerURL"),new Je);break;case 8:if(!f.npm.enabled)return;e=new vr(new Lt(f.npm.index,"npm.indexServerURL"),new hr);break;case 5:if(!f.php.enabled)return;e=new Ir(new or(f.php.index,"php.indexServerURL"),new ze);break;case 4:if(console.log("Python"),!f.python.enabled)return;let r=Wo.default.basename(t.document.fileName),n=r==="pyproject.toml"||r==="pixi.toml"?new Qe:new He;e=new xr(new ar(f.python.index,"python.indexServerURL"),n);break;case 6:if(!f.dart.enabled)return;e=new Pr(new Tr(f.dart.index,"dart.indexServerURL"),new et);break;case 7:if(!f.csharp.enabled)return;e=new _r(new wr(f.csharp.index,"csharp.indexServerURL"),new ke);break}if(e!==void 0&&(f.api.key!==""&&f.api.url!==""&&(y===1&&e instanceof _t?(await e.loadAlternateRegistries(t),e.fetcher=new Tt(f.api.url,"apiURL")):e=new Er(new Tt(f.api.url,"apiURL"),e.parser)),!O.inProgress))return O.inProgress=!0,w.fetching(""),w.show(),e?.parseAndDecorate(t).finally(()=>{O.inProgress=!1})}var rt=Vt.workspace.getConfiguration("dependi"),Ho=Vt.commands.registerTextEditorCommand(L.DISABLE_LOCK_FILE_PARSING,(t,e,r)=>{if(t){switch(y){case 1:rt.update("rust.lockFileEnabled",!1);break;case 3:rt.update("npm.lockFileEnabled",!1);break;case 5:rt.update("php.lockFileEnabled",!1);break;case 4:rt.update("python.lockFileEnabled",!1);break;case 6:rt.update("dart.lockFileEnabled",!1);break;case 7:rt.update("csharp.lockFileEnabled",!1);break;default:break}Vt.commands.executeCommand("setContext","dependi.isLockFileEnabled",!1),setTimeout(()=>{te(t)},1e3)}});var $t=require("vscode");var nt=$t.workspace.getConfiguration("dependi"),jo=$t.commands.registerTextEditorCommand(L.ENABLE_LOCK_FILE_PARSING,(t,e,r)=>{if(t){switch(y){case 1:nt.update("rust.lockFileEnabled",!0);break;case 3:nt.update("npm.lockFileEnabled",!0);break;case 5:nt.update("php.lockFileEnabled",!0);break;case 4:nt.update("python.lockFileEnabled",!0);break;case 6:nt.update("dart.lockFileEnabled",!0);break;case 7:nt.update("csharp.lockFileEnabled",!0);break;default:break}$t.commands.executeCommand("setContext","dependi.isLockFileEnabled",!0),setTimeout(()=>{te(t)},1e3)}});var it=require("vscode");var st=it.workspace.getConfiguration("dependi"),Go=it.commands.registerTextEditorCommand(L.LOCK_FILE_PARSED,(t,e,r)=>{if(t){switch(y){case 1:st.update("rust.lockFileEnabled",!1);break;case 3:st.update("npm.lockFileEnabled",!1);break;case 5:st.update("php.lockFileEnabled",!1);break;case 4:st.update("python.lockFileEnabled",!1);break;case 6:st.update("dart.lockFileEnabled",!1);break;case 7:st.update("csharp.lockFileEnabled",!1);break;default:break}it.commands.executeCommand("setContext","dependi.hasLockFile",!1),it.commands.executeCommand("setContext","dependi.isLockFileEnabled",!1),setTimeout(()=>{te(t)},1e3)}});var ot=require("vscode");var Xo=ot.commands.registerTextEditorCommand(L.REPLACE_VERSIONS,(t,e,r)=>{if(t&&r&&!O.inProgress){O.inProgress=!0;let n=C.get(y)?.get(r.key+r.startLine);if(!n){O.inProgress=!1;return}let s=new ot.Range(n.item.range.start.line,n.item.range.start.character,n.item.range.end.line,n.item.range.end.character),i=r.version,c=t.document.getText(s).match(/^(\^|~|>=?|<=?|=)?(v|V)?/);if(c&&c[0]){let a=c[1]||"",l=c[2]||"",u=i.replace(/^(\^|~|>=?|<=?|=)?(v|V)?/,"");i=a+l+u}e.replace(s,i),O.inProgress=!1}ot.workspace.save(t.document.uri).then(n=>{n||(console.error("Failed to save",n),P.appendLine(`Failed to save ${n}`))})});var at=require("vscode");var Ko=at.commands.registerTextEditorCommand(L.UPDATE_ALL,(t,e)=>{if(!t||O.inProgress){console.debug("Editor is undefined or in progress",t,O.inProgress);return}O.inProgress=!0,console.debug("Replacing All");for(let r=O.updateAllData.length-1;r>-1;r--){let n=O.updateAllData[r];if(n.version===""){console.debug("Version is empty",n),P.appendLine(`Version is empty ${n}`);continue}let s=C.get(y)?.get(n.key+n.startLine);if(!s){console.error("Dependency not found",n.key),P.appendLine(`Dependency not found ${n.key}`);continue}let i=new at.Range(s.item.range.start.line,s.item.range.start.character,s.item.range.end.line,s.item.range.end.character),o=n.version,a=t.document.getText(i).match(/^(\^|~|>=?|<=?|=)?(v|V)?/);if(a&&a[0]){let l=a[1]||"",u=a[2]||"",p=o.replace(/^(\^|~|>=?|<=?|=)?(v|V)?/,"");o=l+u+p}e.replace(i,o)}O.inProgress=!1,at.workspace.save(t.document.uri).then(r=>{r?console.debug("Saved",r):(console.error("Failed to save",r),P.appendLine(`Failed to save ${r}`))})});var De=require("vscode");var Cr=require("vscode");var Rf=[{ID:1,Name:"Cargo.toml"},{ID:2,Name:"go.mod"},{ID:3,Name:"package.json"},{ID:5,Name:"composer.json"},{ID:4,Name:"requirements.txt"},{ID:6,Name:"pubspec.yaml"},{ID:7,Name:"directory.build.props"},{ID:7,Name:"directory.packages.props"}],Qn=t=>{let e=Rf.find(r=>r.Name.toLowerCase()===t.toLowerCase());return e?e.ID:t.toLowerCase().endsWith(".csproj")?7:0};async function Yo(t,e){return await Re("v1/reports/vulnerability",{method:"POST",headers:{Authorization:f.api.key,"X-Device-ID":f.api.deviceID,"Content-Type":"application/json"},body:JSON.stringify(t),...e})}async function Jo(t,e){return await Re("v1/reports/vulnerability/current",{method:"POST",headers:{Authorization:f.api.key,"X-Device-ID":f.api.deviceID,"Content-Type":"application/json"},body:JSON.stringify(t),...e})}async function zo(t,e){return await Re("v1/reports/pdf",{method:"POST",body:JSON.stringify(t),headers:{Authorization:f.api.key,"X-Device-ID":f.api.deviceID,"Content-Type":"application/json"},...e})}var de=require("vscode");var Qo=S(require("os")),Zo=require("vscode");var Zn=t=>{switch(t){case"Cargo.toml":return new Ge;case"go.mod":return new Xe;case"package.json":return new Je;case"composer.json":return new ze;case"requirements.txt":return new He;case"pyproject.toml":return new Qe;case"pubspec.yaml":return new et;case"Directory.Build.props":case"Directory.Packages.props":return new ke;default:if(t.endsWith(".csproj"))return new ke;throw Error("Language not supported")}},ct=t=>{if(Qo.default.platform()!=="win32")return t;let e=t.slice(1);return e=e.replace(/\\/g,"/")};function es(t){if(t.status!==200)switch(We(t.error)){case"Device Limit reached. You can edit your api key or visit dependi.io dashboard to manage devices.":jt();break;case"Payment required. Please visit dependi.io dashboard to update your payment method.":Gt();break;case"Unauthorized, please check your api key.":me("apiKey","Unauthorized, please check your api key.");break;case"Invalid api key or api key not found. Please check your api key.":me("apiKey","Invalid api key or api key not found. Please check your api key.");break;case"User is not active. Please check emails from us or visit dependi.io dashboard.":me("apiKey","User is not active. Please check emails from us or visit dependi.io dashboard.");break;default:Zo.window.showErrorMessage(We(t.error))}}async function ts(){let t=de.extensions.getExtension("vscode.git").exports;if(!t)throw new Error("Git extension not found");let r=t.getAPI(1).repositories;if(!r||r.length===0)throw new Error("No repository found");let n=de.window.activeTextEditor;if(!n)throw new Error("Active editor not found");let s=n.document.uri.fsPath;return{repo:r.find(o=>s.includes(o.rootUri.fsPath))}}async function ea(){let{repo:t}=await ts(),e=t.rootUri,r,n=ct(e.path);return e&&(r=n.split("/").pop()),{repoName:r,repoRootUri:e}}async function ta(t){let e=de.window.activeTextEditor;if(!e)throw new Error("Active editor not found");let r=e.document.uri,n=ct(r.path),s=await t.log({path:n});if(!s||s.length===0)throw new Error("There is no commit history on the active file");return{commits:s}}async function ra(t,e,r,n){let s=ct(de.window.activeTextEditor.document.uri.path),i=await e.show(r,s),o=await de.workspace.openTextDocument({language:n,content:i});return de.window.showTextDocument(o).then(()=>de.commands.executeCommand("workbench.action.revertAndCloseActiveEditor")),t.parse(o)}var If={fetchingRepository:{label:"Fetching current repository",percentage:5},parsingFile:{label:"Parsing current file",percentage:10},comparingFiles:{label:"Comparing files",percentage:25},generatingReport:{label:"Generating vulnerability report",percentage:55},creatingUI:{label:"Creating Report",percentage:80}};async function na(){let{repo:t}=await ts(),{commits:e}=await ta(t),{repoName:r,repoRootUri:n}=await ea(),s=e[0]?.hash,i=e[0]?.authorEmail;if(!s)throw new Error("No commits found in the repository.");return{repo:t,commits:e,repoName:r,repoRootUri:n,commitId:s,author:i}}async function sa(){let t=Cr.window.activeTextEditor;if(!t)throw new Error("Active editor not found");let e=t.document.fileName||"";if(e==="")throw new Error("File name has not been found.");let r=e.split(/[/\\]/).pop();if(!r)throw new Error("Failed to extract file name with extension.");return{editor:t,fileName:r}}function Ae(t,e,r){let{percentage:n,label:s}=If[e];return t.report({increment:n,message:`Progress: ${r+n}% ${s}`}),r+n}async function vf(t,e,r,n){let s=Cr.window.activeTextEditor;if(!s)throw new Error("Active editor not found");let i=t.parse(s.document),o=await ra(t,e,r,n),c=i.map(l=>({Key:l.key,Value:l.value||""})),a=o.map(l=>({Key:l.key,Value:l.value||""}));return{currentReportItems:c,previousReportItems:a}}async function ia(t){let e=0;try{e=Ae(t,"fetchingRepository",e);let{repo:r,commits:n,repoName:s,repoRootUri:i,commitId:o,author:c}=await na(),{fileName:a}=await sa();e=Ae(t,"parsingFile",e);let l=Zn(a),{currentReportItems:u,previousReportItems:p}=await vf(l,r,o,a);if(!i)throw new Error("Repository root URI not found");e=Ae(t,"generatingReport",e);let d={RepoName:s||"",Commits:n||[],PreviousItems:p,CurrentItems:u,Language:Qn(a),GHSACheck:f.vulnerability.ghsa,Author:c},m=await Yo(d);if(!m)throw new Error("Failed to generate report");es(m);let b=m.body||"";return e=Ae(t,"creatingUI",e),b}catch(r){throw new Error(`Error during report generation: ${r}`)}}async function oa(t){let e=0;try{let{fileName:r}=await sa(),{commits:n,repoName:s,author:i}=await na();e=Ae(t,"parsingFile",e);let o=Zn(r),{reportItems:c}=await xf(o);e=Ae(t,"generatingReport",e);let a={RepoName:s||"",Commits:n||[],PreviousItems:[],CurrentItems:c,Language:Qn(r),GHSACheck:f.vulnerability.ghsa,Author:i},l=await Jo(a);es(l);let u=l.body||"";return e=Ae(t,"creatingUI",e),u}catch(r){throw new Error(`Error during report generation: ${r}`)}}async function xf(t){let e=Cr.window.activeTextEditor;if(!e)throw new Error("Active editor not found");return{reportItems:t.parse(e.document).map(s=>({Key:s.key,Value:s.value?.replace(/[=><]/g,"")||""}))}}var X=S(require("vscode"));var xe=class{constructor(e,r){this._disposables=[];this._panel=e,this._extensionUri=r,this._panel.onDidDispose(()=>this.dispose(),null,this._disposables)}dispose(){for(this._panel.dispose();this._disposables.length;){let e=this._disposables.pop();e&&e.dispose()}}_getWebviewContent(){return""}};var lt=class t extends xe{constructor(e,r,n){super(e,r),this.fetchedHTML=n,this._panel.webview.html=this.getWebviewContent(n),this._setWebviewMessageListener(this._panel.webview)}static render(e,r){let n=X.window.createWebviewPanel("vulnerabilityReport","Vulnerability Report",{viewColumn:X.ViewColumn.One,preserveFocus:!0},{enableScripts:!0,retainContextWhenHidden:!0});return new t(n,e,r)}_getVulnerabilityReportHtml(e){return e}getWebviewContent(e){return this._getVulnerabilityReportHtml(e)}async handleExportReport(){let e=this.getSaveText(),r={saveLabel:"Save PDF",filters:{"PDF Files":["pdf"]},defaultUri:X.Uri.file(e)},n=await X.window.showSaveDialog(r);if(n){let s=this._getVulnerabilityReportHtml(this.fetchedHTML);s=this.addHideClassToExportButton(s);let i=await zo(s);if(!i||!i.body||i.body.size===0){X.window.showErrorMessage("Error exporting PDF.");return}let o=await this.blobToUint8Array(i.body),c=n.path,a=ct(c),l=X.Uri.file(a);await X.workspace.fs.writeFile(l,o),X.window.showInformationMessage(`Report saved to ${n.fsPath}`,"Open File").then(async u=>{if(u==="Open File"){let p=X.Uri.file(n.fsPath);await X.env.openExternal(p)}})}}_setWebviewMessageListener(e){e.onDidReceiveMessage(async r=>{if(r.command==="exportReport")try{await this.handleExportReport()}catch(n){console.error("Failed to save PDF: ",n),P.appendLine("Failed to save PDF: "+n),X.window.showErrorMessage("Error exporting PDF.")}},void 0,this._disposables)}getSaveText(){let e=new Date,r=e.getHours(),n=e.getMinutes(),s=r<10?"0"+r:r,i=n<10?"0"+n:n;return`Vulnerability_Report-${e.toISOString().split("T")[0]}-${s}_${i}.pdf`}addHideClassToExportButton(e){return e.replace('<button id="pdf-export-button">','<button id="pdf-export-button" class="hide-in-pdf">')}async blobToUint8Array(e){let r=await e.arrayBuffer();return new Uint8Array(r)}};var aa=t=>De.commands.registerCommand(L.GENERATE_VULNERABILITY_CURRENT_REPORT,async()=>{let e={location:De.ProgressLocation.Notification,title:"Loading Report",cancellable:!1};De.window.withProgress(e,oa).then(r=>{r&&lt.render(t.extensionUri,r)},r=>{De.window.showErrorMessage(`Report generation failed: ${r}`)})});var Ve=require("vscode");var ca=t=>Ve.commands.registerCommand(L.GENERATE_VULNERABILITY_REPORT,async()=>{let e={location:Ve.ProgressLocation.Notification,title:"Loading Report",cancellable:!1};Ve.window.withProgress(e,ia).then(r=>{r&&lt.render(t.extensionUri,r)},r=>{Ve.window.showErrorMessage(`Report generation failed: ${r}`)})});var la=require("vscode");var ua=la.commands.registerTextEditorCommand(L.RETRY,(t,e,r)=>{t&&(C.delete(y),te(t))});var Vr=S(require("vscode"));var pa=require("fs"),Ar=require("vscode");function kr(t){let e=t.replace(/!\[([^\]]+)\]\(([^)]+)\)/g,'<img src="$2" alt="$1">');return e=e.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2">$1</a>'),e=e.replace(/^#\s(.*)$/gm,"<h1>$1</h1>"),e=e.replace(/^##\s(.*)$/gm,"<h2>$1</h2>"),e=e.replace(/^###\s(.*)$/gm,"<h4>$1</h4>"),e=e.replace(/_([^_]+)_/g,"<em>$1</em>"),e=e.replace(/^\s*-\s(.*)$/gm,"<li>$1</li>"),e=e.replace(/<li>(.*)<\/li>/g,"<ul>$&</ul>"),e}function fa(t,e,r){let n=Ar.Uri.joinPath(e,"icon.png"),s=t.asWebviewUri(n),i=Ar.Uri.joinPath(e,"changelog.md"),o=(0,pa.readFileSync)(i.fsPath,"utf8"),c=kr(o),a=Ar.Uri.joinPath(e,"templates","welcome-page","style.css");return`<!DOCTYPE html>
  <html lang="en">
  <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <link rel="stylesheet" type="text/css" href="${t.asWebviewUri(a)}">
          <title>Welcome to Dependi</title>
        </head>
          
          <body>
          <div class="header">
          <div class="logo">
          <img src="${s}" alt="logo" width="128" height="128">
          </div>
          <div class="logo-header">
          <h1>Dependi <em>v${r}</em> </h1>
         
          <p>Welcome to <b>Dependi</b>. Empowers developers to efficiently manage dependencies and address vulnerabilities in Rust, Go, JavaScript, TypeScript, Python and PHP projects.</p>
          </div>
    </div>
    <p>  Don\`t forget that a <b><a href="https://www.dependi.io/#pricing" class="cta">Free trial</a> of PRO</b> is waiting for you.
      <div class="changelog" >
          ${c}
      </div>
    </p>
  </body>
  </html>`}var Dr=class t extends xe{constructor(e,r,n,s){super(e,r),this.context=n,this._panel.webview.html=this.getWebviewContent(s)}getWebviewContent(e){return this._getHTML(e)}static render(e){let r=Vr.window.createWebviewPanel("changelogDependi","Dependi Changelog",Vr.ViewColumn.One,{}),n=new t(r,e.extensionUri,e,f.version)}_getHTML(e){return fa(this._panel.webview,this._extensionUri,e)}};var Fr=S(require("vscode"));var rs=require("fs"),Ft=require("vscode");function da(t,e,r){let n=Ft.Uri.joinPath(e,"icon.png"),s=t.asWebviewUri(n),i=Ft.Uri.joinPath(e,"changelog.md"),o=(0,rs.readFileSync)(i.fsPath,"utf8"),c=kr(o),a=Ft.Uri.joinPath(e,"templates","welcome-page","style.css"),l=Ft.Uri.joinPath(e,"templates","welcome-page","features.html"),u=t.asWebviewUri(a),p=(0,rs.readFileSync)(l.fsPath,"utf8");return`<!DOCTYPE html>
  <html lang="en">
  
  <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <link rel="stylesheet" type="text/css" href="${u}">
          <title>Welcome to Dependi</title>
        </head>
          
          <body>
          <div class="header">
          <div class="logo">
          <img src="${s}" alt="logo" width="128" height="128">
          </div>
          <div class="logo-header">
          <h1>Dependi <em>v${r}</em> </h1>
         
          <p>Welcome to <b>Dependi</b>. Empowers developers to efficiently manage dependencies and address vulnerabilities in Rust, Go, JavaScript, TypeScript, Python and PHP projects.</p>
          </div>
    </div>
    <div class="split">
      <div class="features">
          <h1>Features</h1>   
          ${p}
      </div>
      <div class="changelog" >
          ${c}
      </div>
    </div>
  
  </body>
  </html>`}var $r=class t extends xe{constructor(e,r,n,s){super(e,r),this.context=n,this._panel.webview.html=this.getWebviewContent(s)}getWebviewContent(e){return this._getWelcomePageHtml(e)}static render(e){let r=Fr.window.createWebviewPanel("welcomeDependi","Welcome to Dependi",Fr.ViewColumn.One,{}),n=new t(r,e.extensionUri,e,f.version)}_getWelcomePageHtml(e){return da(this._panel.webview,this._extensionUri,e)}};var ma=require("crypto"),ha=S(It());var $e={deviceID:L.DEVICE_ID,shownVersion:L.SHOWN_VERSION},Ur=class{constructor(e){this.context=e,this.context.globalState.setKeysForSync([$e.shownVersion])}initDeviceID(){let e=this.getDeviceID();if(!e||e.length!==36){let r=(0,ma.randomUUID)();return this.setDeviceID(r).then(()=>r)}return Promise.resolve(e)}setDeviceID(e){return console.debug("setDeviceID",e),this.context.globalState.update($e.deviceID,e)}getDeviceID(){return console.debug("getDeviceID",this.context.globalState.get($e.deviceID)),this.context.globalState.get($e.deviceID)}setShownVersion(e){return console.debug("setShownVersion",e),this.context.globalState.update($e.shownVersion,e)}getShownVersion(){return console.debug("getShownVersion",this.context.globalState.get($e.shownVersion)),this.context.globalState.get($e.shownVersion)}shouldShowWelcomePage(e){return(0,ha.gt)(e,this.getShownVersion()??"0.0.0")}isFirstInstall(){return!this.getShownVersion()}};var P;function Pf(t){P=H.window.createOutputChannel("Dependi"),console.debug('Congratulations, your extension "dependi" is now active!'),P.appendLine('Congratulations, your extension "dependi" is now active!'),f.load(),H.workspace.onDidChangeConfiguration(e=>{switch(f.onChange(e),!0){case e.affectsConfiguration("dependi.npm.unstableFilter"):C.delete(3);break;case e.affectsConfiguration("dependi.python.unstableFilter"):C.delete(4);break;case e.affectsConfiguration("dependi.rust.unstableFilter"):C.delete(1);break;case e.affectsConfiguration("dependi.go.unstableFilter"):C.delete(2);break;case e.affectsConfiguration("dependi.php.unstableFilter"):C.delete(5);break;case e.affectsConfiguration("dependi.dart.unstableFilter"):C.delete(6);break;case e.affectsConfiguration("dependi.csharp.unstableFilter"):C.delete(7);break;case e.affectsConfiguration("dependi.decoration"):Ro(),H.window.activeTextEditor&&te(H.window.activeTextEditor);break;default:break}}),Bt(H.window.activeTextEditor?.document.fileName),Lf(t).finally(()=>te(H.window.activeTextEditor)),t.subscriptions.push(H.window.onDidChangeActiveTextEditor(e=>{if(Bt(H.window.activeTextEditor?.document.fileName),y!==0)return console.debug("Active text editor changed",y),te(e)}),H.workspace.onDidChangeTextDocument(e=>{e.document.fileName===H.window.activeTextEditor?.document.fileName&&y!==0&&(Bt(H.window.activeTextEditor?.document.fileName),console.debug("Text document changed",y),e.document.isDirty||te(H.window.activeTextEditor))})),H.commands.executeCommand("setContext","dependi.supportedFiles",["Cargo.toml","go.mod","package.json","composer.json","requirements.txt","requirements-dev.txt","pyproject.toml","pubspec.yaml","directory.build.props","directory.packages.props"]),console.debug("Adding commands"),t.subscriptions.push(ua),t.subscriptions.push(Xo),t.subscriptions.push(Ko),t.subscriptions.push(ca(t)),t.subscriptions.push(aa(t)),t.subscriptions.push(Ho),t.subscriptions.push(jo),t.subscriptions.push(Go)}function Tf(){P.dispose()}async function Lf(t){let e=new Ur(t),r=await e.initDeviceID();f.api.deviceID=r,f.version=t.extension.packageJSON.version,e.isFirstInstall()?(P.appendLine("First install"),$r.render(t),await e.setShownVersion(f.version)):e.shouldShowWelcomePage(t.extension.packageJSON.version)&&(P.appendLine("Updated version"),f.extras.silenceUpdateMessages||H.window.showInformationMessage("Dependi has been updated to a new version. See the CHANGELOG!","Show Changelog","Dismiss").then(n=>{n==="Show Changelog"&&Dr.render(t)}),await e.setShownVersion(t.extension.packageJSON.version))}0&&(module.exports={Logger,activate,deactivate});
